ANALYTICS ENGINE v5.0

VERSION: 5.5
DATE: January 2026
STATUS: Production Ready
COMPLIANCE: 6-Rule Compliant
================================================================================
SECTION 1: PURPOSE AND SCOPE
================================================================================

1.1 PURPOSE

This document defines the complete analytical methodology for the Media Planning Agent. It specifies calculation formulas, forecasting models, validation rules, and measurement frameworks that the agent MUST use when building, optimizing, and evaluating media plans.

The Analytics Engine serves as the mathematical foundation for all agent projections, recommendations, and performance assessments. Every calculation the agent performs MUST be traceable to the specifications in this document.

1.2 SCOPE

This document covers:

- Media Mix Modeling (MMM) fundamentals and application
- Adstock and carryover effect calculations
- Reach and frequency models
- Diminishing returns and response curve modeling
- Budget allocation optimization
- Media flighting and scheduling strategies
- Attribution modeling frameworks
- Incrementality testing methodology
- Customer Lifetime Value (LTV) models including probabilistic approaches
- Decile analysis and marginal dollar optimization
- Cohort and vintage analysis for 5-year lifecycle forecasting
- Advanced statistical framework including power analysis and significance
- Secondary effects and guardrail metrics for comprehensive measurement
- Confidence level calculations
- Validation thresholds and triggers

1.3 CORE PRINCIPLES

PRINCIPLE 1: SHOW YOUR WORK
The agent MUST show calculations and formulas when presenting projections. Users deserve to understand how numbers were derived.

PRINCIPLE 2: ACKNOWLEDGE UNCERTAINTY
All projections carry uncertainty. The agent MUST communicate confidence levels and ranges, not single point estimates.

PRINCIPLE 3: DATA PROVENANCE
Every calculation MUST cite its data source. Internal benchmarks, user-provided data, and web research MUST be clearly distinguished.

PRINCIPLE 4: CONSERVATIVE DEFAULTS
When data is limited, default to conservative estimates. Underestimating slightly is safer than overestimating.

PRINCIPLE 5: VALIDATE CONTINUOUSLY
Projections MUST be validated against benchmarks at every step. Flag deviations early.

================================================================================
SECTION 2: MEDIA MIX MODELING FUNDAMENTALS
================================================================================

2.1 MMM DEFINITION AND APPROACH

Media Mix Modeling (MMM) is a statistical analysis technique used to quantify the impact of marketing activities on business outcomes. MMM uses regression analysis on historical data to determine the contribution of each marketing channel to sales or other KPIs.

CORE MMM FORMULA:
Sales = Baseline + B1(Channel1) + B2(Channel2) + ... + Bn(ChannelN) + External_Factors + Error

Where:
- Baseline = Sales that would occur without marketing (organic demand)
- B1...Bn = Coefficients representing channel effectiveness
- External_Factors = Seasonality, economic conditions, competition
- Error = Unexplained variance

2.2 KEY MMM COMPONENTS

DEPENDENT VARIABLE:
- Sales revenue
- Conversions
- Leads
- New customer acquisition
- Other business KPIs

INDEPENDENT VARIABLES (Marketing Inputs):
- Advertising spend by channel
- GRPs or impressions by channel
- Promotional activities
- Pricing changes
- Distribution changes

CONTROL VARIABLES (External Factors):
- Seasonality (monthly, weekly, holiday)
- Economic indicators
- Competitive activity
- Weather conditions
- Category trends

2.3 MMM OUTPUT METRICS

CONTRIBUTION:
The absolute sales volume attributed to each marketing element.
Formula: Contribution = Coefficient times Marketing_Input

EFFECTIVENESS:
The volume generated per unit of marketing effort.
Formula: Effectiveness = Contribution divided by Marketing_Spend

ROI:
Return on marketing investment.
Formula: ROI = (Contribution times Margin minus Marketing_Spend) divided by Marketing_Spend

ELASTICITY:
Percentage change in sales for a 1 percent change in marketing spend.
Formula: Elasticity = (Percent_Change_Sales) divided by (Percent_Change_Spend)

2.4 MMM LIMITATIONS AND AGENT GUIDANCE

LIMITATION 1: Historical data requirement
MMM requires 2-3 years of clean, consistent data for robust results.
AGENT GUIDANCE: When historical data is limited, use industry benchmarks with MEDIUM-LOW confidence.

LIMITATION 2: Multicollinearity
Channels often move together, making it hard to isolate individual effects.
AGENT GUIDANCE: Use benchmarks for channel decomposition when user spend is highly correlated.

LIMITATION 3: Aggregate level
MMM provides channel-level insights, not campaign or creative level.
AGENT GUIDANCE: Supplement with platform-reported metrics for tactical optimization.

================================================================================
SECTION 3: ADSTOCK AND CARRYOVER EFFECTS
================================================================================

3.1 ADSTOCK DEFINITION

Adstock (advertising stock) measures the prolonged effect of advertising beyond the period of initial exposure. It captures how advertising builds awareness that persists and decays over time.

The theory: Advertising creates memory traces that influence purchase decisions even after exposure stops. Each new exposure builds awareness, which then decays gradually in the absence of further advertising.

3.2 GEOMETRIC ADSTOCK MODEL

The most common adstock transformation uses geometric decay:

FORMULA:
Adstock_t = Spend_t + (Decay_Rate times Adstock_t-1)

Where:
- Adstock_t = Transformed advertising effect at time t
- Spend_t = Raw advertising spend at time t
- Decay_Rate = Carryover rate (0 to 1)
- Adstock_t-1 = Previous period adstock

HALF-LIFE CALCULATION:
Half-life is the time for advertising effect to decay by 50 percent.
Formula: Half_Life = ln(0.5) divided by ln(Decay_Rate)

DECAY RATE FROM HALF-LIFE:
Formula: Decay_Rate = 0.5 raised to (1 divided by Half_Life)

EXAMPLE CALCULATION:
- Week 1 spend: 10,000 dollars, Decay rate: 0.6
- Week 1 Adstock: 10,000
- Week 2 spend: 0, Adstock: 0 + (0.6 times 10,000) = 6,000
- Week 3 spend: 0, Adstock: 0 + (0.6 times 6,000) = 3,600
- Week 4 spend: 0, Adstock: 0 + (0.6 times 3,600) = 2,160

3.3 WEIBULL ADSTOCK MODEL

For more complex decay patterns, including delayed peak effects:

FORMULA:
Decay_Rate_t = exp(-(t divided by Scale) raised to Shape)

Where:
- Shape parameter controls curve steepness
- Scale parameter controls time to peak effect
- Allows for modeling delayed response (common in high-consideration purchases)

USE CASES:
- Delayed peak: B2B, automotive, real estate (Shape greater than 1)
- Immediate peak: CPG, impulse purchases (Shape less than 1)

3.4 TYPICAL ADSTOCK RATES BY CHANNEL

CHANNEL: Television
- Typical Decay Rate: 0.3 to 0.8
- Half-Life: 1 to 4 weeks
- Rationale: High emotional impact, strong memory formation

CHANNEL: Radio
- Typical Decay Rate: 0.1 to 0.4
- Half-Life: 0.5 to 2 weeks
- Rationale: Background medium, lower attention

CHANNEL: Out of Home
- Typical Decay Rate: 0.1 to 0.4
- Half-Life: 0.5 to 2 weeks
- Rationale: Immediate reminder effect, quick decay

CHANNEL: Print
- Typical Decay Rate: 0.2 to 0.5
- Half-Life: 1 to 3 weeks
- Rationale: Longer exposure time, can be revisited

CHANNEL: Digital Display
- Typical Decay Rate: 0.0 to 0.3
- Half-Life: Less than 1 week
- Rationale: Quick exposure, low attention, fast decay

CHANNEL: Paid Search
- Typical Decay Rate: 0.0 to 0.2
- Half-Life: Less than 1 week
- Rationale: Intent-based, immediate action orientation

CHANNEL: Social Media
- Typical Decay Rate: 0.1 to 0.4
- Half-Life: 0.5 to 2 weeks
- Rationale: Varies by format (video higher, static lower)

AGENT GUIDANCE:
- For awareness campaigns, assume higher decay rates (longer-lasting effects)
- For direct response, assume lower decay rates (immediate action)
- Always disclose adstock assumptions to user

================================================================================
SECTION 4: REACH AND FREQUENCY MODELS
================================================================================

4.1 FUNDAMENTAL DEFINITIONS

REACH:
The percentage or number of unique individuals in the target audience exposed to advertising at least once during a specified period.
- Usually expressed as a percentage of target audience
- Maximum theoretical reach is 99 percent (some individuals unreachable)

FREQUENCY:
The average number of times each reached individual is exposed to the advertising during a specified period.
- Formula: Frequency = GRPs divided by Reach
- Also called average OTS (opportunities to see)

GROSS RATING POINTS (GRPs):
Total advertising weight combining reach and frequency.
- Formula: GRPs = Reach (as percentage) times Frequency
- 1 GRP = reaching 1 percent of target audience once

4.2 REACH CURVE MATHEMATICS

Reach does not increase linearly with GRPs. It follows a diminishing returns curve:

GENERAL REACH CURVE FORMULA:
Reach = Maximum_Reach times (1 minus exp(-k times GRPs))

Where:
- Maximum_Reach = Asymptotic maximum (typically 70-90 percent)
- k = Rate constant (channel-specific)
- GRPs = Gross rating points purchased

TYPICAL REACH BENCHMARKS:
- At 100 GRPs: Approximately 40-50 percent reach
- At 200 GRPs: Approximately 55-65 percent reach
- At 300 GRPs: Approximately 65-75 percent reach
- At 400 GRPs: Approximately 70-80 percent reach
- Beyond 400 GRPs: Diminishing incremental reach

4.3 EFFECTIVE FREQUENCY FRAMEWORK

Not all exposures are equal. Effective frequency defines the minimum exposures needed for impact.

OSTROW MODEL COMPONENTS:
Starting base frequency: 3.0 exposures

MARKETING FACTORS (adjust plus or minus 0.2 each):
- Established brand: Decrease frequency
- New brand: Increase frequency
- Low market share: Increase frequency
- High purchase cycle: Decrease frequency
- Infrequent usage: Increase frequency

MESSAGE FACTORS (adjust plus or minus 0.2 each):
- Simple message: Decrease frequency
- Complex message: Increase frequency
- Unique message: Decrease frequency
- Similar to competition: Increase frequency
- High wear-out potential: Increase frequency

MEDIA FACTORS (adjust plus or minus 0.2 each):
- Low clutter environment: Decrease frequency
- High clutter environment: Increase frequency
- High attentiveness: Decrease frequency
- Low attentiveness: Increase frequency
- Continuous scheduling: Decrease frequency
- Flighted scheduling: Increase frequency

TYPICAL EFFECTIVE FREQUENCY RANGES:
- Brand awareness: 3 to 5 exposures
- Message comprehension: 5 to 7 exposures
- Attitude change: 7 to 10 exposures
- Purchase intent: 8 to 12 exposures

4.4 REACH VS FREQUENCY OPTIMIZATION

OPTIMIZE FOR REACH WHEN:
- Launching new products or brands
- Broad target audience
- Simple message
- Long purchase cycle
- Building awareness as primary objective
- Minimum reach not yet achieved (below 60 percent)

OPTIMIZE FOR FREQUENCY WHEN:
- Established brand needing reinforcement
- Narrow target audience
- Complex message
- Short purchase cycle
- Conversion as primary objective
- Facing high competitive clutter

AGENT CALCULATION:
Given budget, CPM, and target audience size:

Total_Impressions = Budget divided by (CPM divided by 1000)
Maximum_Reach_Achievable = Audience_Size times Reach_Curve(GRPs)
Average_Frequency = Total_Impressions divided by (Maximum_Reach times Audience_Size)

================================================================================
SECTION 5: DIMINISHING RETURNS AND RESPONSE CURVES
================================================================================

5.1 RESPONSE CURVE FUNDAMENTALS

Response curves describe the relationship between marketing investment and business outcomes. Understanding the shape of this curve is critical for budget optimization.

FOUR PRIMARY CURVE TYPES:

LINEAR:
- Formula: Sales = A + B times Spend
- Constant returns at all spend levels
- Rare in practice
- Assumes infinite scalability (unrealistic)

CONCAVE (Diminishing Returns):
- Formula: Sales = A times Spend raised to B, where B less than 1
- Returns diminish as spend increases
- Most common in marketing
- Appropriate for mature channels

S-CURVE (Logistic):
- Formula: Sales = S_max divided by (1 + exp(-B times (Spend minus Inflection)))
- Low returns initially (threshold effect)
- High returns in middle range
- Diminishing returns at high levels
- Common for TV and brand campaigns

CONVEX:
- Formula: Sales = A times Spend raised to B, where B greater than 1
- Returns increase as spend increases
- Rare, indicates undersaturation
- May occur in emerging channels or early growth

5.2 SATURATION POINT IDENTIFICATION

The saturation point is where additional spend generates negligible incremental returns.

MATHEMATICAL DEFINITION:
Saturation occurs when marginal ROI approaches 1.0 (break-even).

FORMULA FOR MARGINAL ROI:
Marginal_ROI = (dRevenue divided by dSpend) times Margin

FINDING SATURATION:
For concave curve Sales = A times Spend raised to B:
Marginal_Sales = A times B times Spend raised to (B minus 1)
Set Marginal_Sales times Margin = 1
Solve for Spend to find saturation point

AGENT GUIDANCE:
- Plot response curve with current spend position marked
- Identify remaining headroom before saturation
- Calculate marginal efficiency at current spend
- Recommend reallocation if channel is saturated

5.3 HILL FUNCTION (S-CURVE) PARAMETERS

The Hill function is commonly used for modeling advertising response:

FORMULA:
Response = Saturation_Level times (Spend raised to Alpha) divided by (K raised to Alpha plus Spend raised to Alpha)

Where:
- Saturation_Level = Maximum achievable response
- K = Half-saturation constant (spend at 50 percent response)
- Alpha = Shape parameter (steepness of curve)

PARAMETER INTERPRETATION:
- Alpha less than 1: More concave (diminishing returns dominant)
- Alpha = 1: Standard Hill curve
- Alpha greater than 1: More S-shaped (threshold effect dominant)

5.4 CHANNEL SATURATION INDICATORS

SIGNAL: Channel is approaching saturation
- Marginal CPM increasing faster than impressions
- Frequency exceeding effective frequency threshold
- Reach curve flattening significantly
- Creative fatigue indicators (CTR declining)
- Diminishing incremental conversions

AGENT RESPONSE:
- Calculate current position on response curve
- Estimate remaining headroom (percent of saturation)
- If greater than 80 percent saturated: Recommend reallocation
- Present alternative channels with lower saturation

================================================================================
SECTION 6: BUDGET ALLOCATION OPTIMIZATION
================================================================================

6.1 OPTIMIZATION OBJECTIVE

The goal of budget allocation optimization is to distribute marketing spend across channels to maximize business outcomes within constraints.

OPTIMIZATION FORMULA:
Maximize: Total_Response = Sum of (Response_Curve_i(Spend_i)) for all channels i
Subject to: Sum of (Spend_i) = Total_Budget
Subject to: Spend_i greater than or equal to Minimum_i for all i
Subject to: Spend_i less than or equal to Maximum_i for all i

6.2 MARGINAL ROI EQUALIZATION

At optimal allocation, marginal ROI should be equal across all channels.

PRINCIPLE:
If Channel A has higher marginal ROI than Channel B, shift budget from B to A until marginal ROIs equalize.

FORMULA:
Marginal_ROI_A = dResponse_A divided by dSpend_A
Optimal when: Marginal_ROI_A = Marginal_ROI_B = ... = Marginal_ROI_N

ITERATIVE ALLOCATION PROCESS:
- Calculate marginal ROI for each channel at current spend
- Identify channel with highest marginal ROI
- Identify channel with lowest marginal ROI
- Shift increment from lowest to highest
- Recalculate marginal ROIs
- Repeat until marginal ROIs converge or constraints bind

6.3 MINIMUM SPEND THRESHOLDS

Channels require minimum spend to achieve meaningful impact.

CHANNEL: Television (National)
- Minimum Weekly GRPs: 100
- Minimum Monthly Budget: 200,000 dollars
- Rationale: Need critical mass for awareness impact

CHANNEL: Television (Local/Cable)
- Minimum Weekly GRPs: 50
- Minimum Monthly Budget: 25,000 to 50,000 dollars
- Rationale: Lower threshold but still need presence

CHANNEL: Radio
- Minimum Weekly GRPs: 100
- Minimum Monthly Budget: 15,000 to 30,000 dollars
- Rationale: Background medium needs repetition

CHANNEL: Out of Home
- Minimum Monthly Budget: 20,000 to 50,000 dollars
- Rationale: Need geographic coverage

CHANNEL: Paid Social
- Minimum Daily Budget per Campaign: 50 to 100 dollars
- Minimum Monthly per Platform: 5,000 to 15,000 dollars
- Rationale: Need data for algorithm optimization

CHANNEL: Paid Search (Non-Brand)
- Minimum Monthly Budget: 5,000 to 20,000 dollars
- Rationale: Need coverage of relevant queries

CHANNEL: Programmatic Display
- Minimum Monthly Budget: 10,000 to 25,000 dollars
- Rationale: Need scale for optimization

AGENT GUIDANCE:
- Do not recommend channel allocations below minimum thresholds
- If budget insufficient for channel, exclude it entirely
- Better to fund fewer channels adequately than many inadequately

6.4 BUDGET ALLOCATION RULES OF THUMB

FOR AWARENESS OBJECTIVES:
- 60 to 70 percent: Broad reach channels (TV, OOH, Video)
- 20 to 30 percent: Digital awareness (Social, Display)
- 10 to 20 percent: Support channels (Search, Retargeting)

FOR CONSIDERATION OBJECTIVES:
- 40 to 50 percent: Content and engagement (Social, Video)
- 30 to 40 percent: Search and discovery (SEM, SEO)
- 20 to 30 percent: Retargeting and nurturing

FOR CONVERSION OBJECTIVES:
- 50 to 60 percent: Performance channels (SEM, Shopping, Social)
- 20 to 30 percent: Retargeting (Display, Social)
- 10 to 20 percent: Awareness maintenance (Brand search, Social)

AGENT GUIDANCE:
- Use these as starting points, then optimize based on response curves
- Always validate allocation against vertical benchmarks
- Flag allocations that deviate significantly from norms

================================================================================
SECTION 7: MEDIA FLIGHTING AND SCHEDULING
================================================================================

7.1 SCHEDULING STRATEGY OVERVIEW

Media scheduling determines how advertising is distributed over time. The three fundamental strategies are continuous, flighting, and pulsing.

7.2 CONTINUOUS SCHEDULING

DEFINITION:
Advertising runs consistently throughout the campaign period with minimal variation in weight.

PATTERN:
Steady spend each week or month with little fluctuation.

BEST FOR:
- Products with constant year-round demand
- Reminder advertising for established brands
- Services with continuous purchase cycles
- Categories with low seasonality

ADVANTAGES:
- Maintains constant presence
- Maximizes total reach over time
- Prevents competitor ambush during gaps
- Supports habitual purchase patterns

DISADVANTAGES:
- May lack impact at any single point
- Expensive to maintain (no budget rest periods)
- May not capitalize on peak demand periods

CALCULATION:
Weekly_Budget = Annual_Budget divided by 52

7.3 FLIGHTING (BURSTING)

DEFINITION:
Advertising runs in concentrated bursts alternating with periods of no advertising.

PATTERN:
Flights of 4 to 8 weeks on, followed by 4 to 8 weeks off.

BEST FOR:
- Seasonal products
- Limited budgets needing concentrated impact
- Product launches and promotions
- Categories with distinct purchase windows

ADVANTAGES:
- Achieves high reach and frequency during active periods
- Conserves budget by eliminating low-return periods
- Creates strong awareness spikes
- Aligns with purchase cycles

DISADVANTAGES:
- Awareness decays during dark periods
- Competitors may fill gaps
- Loses continuous presence
- May miss off-cycle purchasers

CALCULATION:
Flight_Budget = Annual_Budget divided by Number_of_Flights
Weekly_Budget_During_Flight = Flight_Budget divided by Flight_Duration_Weeks

7.4 PULSING

DEFINITION:
Combines continuous and flighting by maintaining low baseline advertising with periodic increases (pulses) during key periods.

PATTERN:
Base level of spend all year with increased investment during peak periods.

PULSE TYPES:

STARTUP PULSE:
- Heavy concentrated media at campaign launch
- Duration: 2 to 4 weeks
- Use: New product introduction, brand launch

PROMOTIONAL PULSE:
- Aligned with specific promotions or events
- Duration: 1 to 2 weeks per promotion
- Use: Sales events, seasonal promotions

SEASONAL PULSE:
- Aligned with seasonal demand peaks
- Duration: 4 to 8 weeks per season
- Use: Holiday retail, summer beverages

PERIODIC PULSE:
- Regular recurring increases
- Pattern: Monthly, quarterly
- Use: Maintaining awareness momentum

ERRATIC PULSE:
- Irregular, opportunistic increases
- Pattern: Responsive to market conditions
- Use: Competitive response, news events

CALCULATION:
Base_Weekly_Budget = Annual_Budget times 0.3 divided by 52
Pulse_Budget = Annual_Budget times 0.7
Pulse_Weekly_Budget = Pulse_Budget divided by Total_Pulse_Weeks

7.5 SCHEDULING DECISION FRAMEWORK

AGENT DECISION TREE:

Question 1: Is demand highly seasonal?
- Yes: Consider FLIGHTING or PULSING with seasonal pulses
- No: Continue to Question 2

Question 2: Is budget sufficient for year-round presence?
- Yes: Consider CONTINUOUS or PULSING
- No: Consider FLIGHTING

Question 3: Is this a new brand or product?
- Yes: Start with STARTUP PULSE then transition
- No: Continue to Question 4

Question 4: Are there promotional events to support?
- Yes: Consider PULSING with promotional pulses
- No: Default to CONTINUOUS if budget allows

Question 5: What is competitive activity pattern?
- Competitors continuous: Match or counter-program
- Competitors flighting: Consider continuous for differentiation

7.6 FLIGHTING OPTIMIZATION

OPTIMAL FLIGHT LENGTH:
Research suggests flights of 4 to 6 weeks achieve best balance of impact and efficiency.

OPTIMAL HIATUS LENGTH:
Hiatus periods should be short enough to prevent complete awareness decay.
- If adstock half-life = 2 weeks: Maximum hiatus 4 weeks
- If adstock half-life = 4 weeks: Maximum hiatus 8 weeks

RECENCY PRINCIPLE:
Advertising closest to purchase has highest impact. Weight flights toward purchase timing.

FORMULA FOR FLIGHT SPACING:
Maximum_Hiatus = 2 times Adstock_Half_Life

================================================================================
SECTION 8: ATTRIBUTION MODELS
================================================================================

8.1 ATTRIBUTION MODEL OVERVIEW

Attribution models assign credit for conversions to marketing touchpoints. The choice of model significantly impacts channel valuation.

8.2 SINGLE-TOUCH ATTRIBUTION MODELS

FIRST-TOUCH ATTRIBUTION:
- 100 percent credit to first touchpoint
- Formula: First touchpoint = 100 percent
- Use case: Understanding awareness drivers
- Limitation: Ignores conversion influence

LAST-TOUCH ATTRIBUTION:
- 100 percent credit to last touchpoint before conversion
- Formula: Last touchpoint = 100 percent
- Use case: Understanding closing channels
- Limitation: Ignores awareness and consideration touchpoints

8.3 MULTI-TOUCH ATTRIBUTION MODELS

LINEAR ATTRIBUTION:
- Equal credit to all touchpoints
- Formula: Each touchpoint = 100 percent divided by Number_of_Touchpoints
- Use case: Long consideration cycles, all touchpoints valued equally
- Example: 4 touchpoints = 25 percent each

TIME-DECAY ATTRIBUTION:
- More credit to touchpoints closer to conversion
- Formula: Credit_i = Decay_Factor raised to (Time_to_Conversion_i)
- Use case: Short sales cycles, recency matters
- Example: Touchpoints at 7, 3, 1 days get 15, 30, 55 percent

POSITION-BASED (U-SHAPED) ATTRIBUTION:
- Heavy credit to first and last touchpoints
- Formula: First = 40 percent, Last = 40 percent, Middle = 20 percent split
- Use case: Valuing both awareness and conversion
- Example: 4 touchpoints = 40, 10, 10, 40 percent

W-SHAPED ATTRIBUTION:
- Heavy credit to first, lead creation, and last touchpoints
- Formula: First = 30 percent, Lead = 30 percent, Last = 30 percent, Others = 10 percent split
- Use case: B2B with identifiable lead stage
- Example: Awareness, form fill, close

FULL-PATH ATTRIBUTION:
- Credits first, lead, opportunity, and close touchpoints
- Formula: First = 22.5 percent, Lead = 22.5 percent, Opportunity = 22.5 percent, Close = 22.5 percent, Others = 10 percent split
- Use case: Complex B2B sales processes

8.4 DATA-DRIVEN ATTRIBUTION

DATA-DRIVEN (ALGORITHMIC):
- Uses machine learning to assign credit based on actual conversion patterns
- Analyzes paths that convert versus paths that do not
- Requires significant conversion volume (typically 1,000 plus conversions)
- Black box in most platforms (limited transparency)

SHAPLEY VALUE ATTRIBUTION:
- Game theory approach to fair value distribution
- Calculates each touchpoints marginal contribution
- More computationally intensive
- Considered most theoretically fair

8.5 ATTRIBUTION MODEL SELECTION GUIDANCE

SELECT FIRST-TOUCH WHEN:
- Primary goal is understanding top-of-funnel
- Building awareness campaigns
- Evaluating prospecting channels

SELECT LAST-TOUCH WHEN:
- Primary goal is understanding bottom-of-funnel
- Short sales cycles (e-commerce)
- Evaluating retargeting effectiveness

SELECT LINEAR WHEN:
- All touchpoints are believed to have equal importance
- Long consideration cycles
- Starting point when uncertain

SELECT TIME-DECAY WHEN:
- Recency of interaction is important
- Shorter sales cycles
- Digital-heavy customer journeys

SELECT POSITION-BASED WHEN:
- First and last touchpoints are most important
- Balanced view of awareness and conversion
- Most versatile for general use

SELECT DATA-DRIVEN WHEN:
- Sufficient conversion volume exists
- Platform provides this option
- Validate against other models

AGENT GUIDANCE:
- Default to POSITION-BASED for balanced view
- Always report which model is used
- Consider multiple models for comparison
- Acknowledge that all models have limitations

================================================================================
SECTION 9: INCREMENTALITY TESTING
================================================================================

9.1 INCREMENTALITY DEFINITION

Incrementality measures the true causal impact of marketing. It answers: How many conversions would NOT have happened without this marketing activity?

FORMULA:
Incremental_Conversions = Total_Conversions minus Baseline_Conversions
Incremental_Lift_Percent = (Incremental_Conversions divided by Baseline_Conversions) times 100
iROAS = Incremental_Revenue divided by Marketing_Spend

9.2 GEO-LIFT TESTING

METHODOLOGY:
Divide geographic regions into test and control groups. Run advertising in test regions, withhold in control. Compare outcomes.

TEST DESIGN:
- Define KPI (revenue, conversions, etc.)
- Select test and control geographies
- Match on historical performance
- Determine test duration (typically 4 to 8 weeks)
- Calculate required minimum detectable effect
- Run test with strict geographic targeting
- Measure lift between test and control

FORMULA:
Lift = (Test_KPI minus Control_KPI) divided by Control_KPI times 100
iROAS = (Test_Revenue minus Control_Revenue) divided by Test_Spend

SYNTHETIC CONTROL METHOD:
When perfect control markets are unavailable:
- Create synthetic control from weighted combination of non-test markets
- Match synthetic control to test market on pre-test period performance
- Compare actual test performance to synthetic control prediction
- Difference is estimated causal lift

9.3 HOLDOUT TESTING

METHODOLOGY:
Randomly assign users to test (exposed to advertising) and control (not exposed). Compare conversion rates.

USER-LEVEL HOLDOUT:
- 90 percent exposed, 10 percent holdout
- Requires ability to suppress ads to holdout users
- Measures true user-level incrementality

GEO HOLDOUT:
- Select markets to receive no advertising
- Simpler to implement than user-level
- Market-level analysis

CALCULATION:
Incremental_Conversion_Rate = Test_CVR minus Control_CVR
Lift_Percent = (Test_CVR minus Control_CVR) divided by Control_CVR times 100

9.4 TEST DURATION AND POWER

MINIMUM TEST DURATION:
- 4 weeks absolute minimum
- 6 to 8 weeks recommended
- Longer for low conversion volume businesses

POWER ANALYSIS:
To detect a 10 percent lift with 80 percent power:
- Need sufficient baseline conversions in control
- Typically 1,000 plus conversions in control period
- Higher variance requires longer tests or larger holdout

FORMULA FOR MINIMUM SAMPLE SIZE:
n = (Z_alpha plus Z_beta) squared times 2 times p times (1 minus p) divided by d squared

Where:
- Z_alpha = 1.96 for 95 percent confidence
- Z_beta = 0.84 for 80 percent power
- p = baseline conversion rate
- d = minimum detectable effect

9.5 INTERPRETING INCREMENTALITY RESULTS

HIGH iROAS (greater than 3x):
- Channel is highly incremental
- Consider increasing investment
- Validate with additional tests

MODERATE iROAS (1.5x to 3x):
- Channel is incremental
- Maintain or cautiously increase
- Monitor for saturation

LOW iROAS (1x to 1.5x):
- Channel is marginally incremental
- Evaluate against alternatives
- May be near saturation

NEGATIVE OR ZERO iROAS:
- Channel may not be incremental
- Consider reducing or eliminating
- Investigate potential cannibalization

AGENT GUIDANCE:
- Recommend incrementality testing for channels exceeding 30 percent of budget
- Use holdout results to calibrate projection models
- Acknowledge that incrementality can vary by campaign and timing

================================================================================
SECTION 10: CALCULATIONS BY PLANNING STEP
================================================================================

10.1 STEP 1: MARKET AND CONTEXT

MARKET SIZE CALCULATION:
Total_Addressable_Market = Category_Buyers times Average_Transaction_Value times Purchase_Frequency

SHARE OF VOICE CALCULATION:
SOV = Brand_Spend divided by Total_Category_Spend times 100

SHARE OF MARKET CORRELATION:
Research shows SOV should exceed SOM for growth.
Growth_Premium = SOV minus SOM
If Growth_Premium positive: Brand likely to gain share

10.2 STEP 2: OBJECTIVES AND KPIS

TARGET VALIDATION:
Compare target against vertical benchmarks.
Deviation_Percent = (Target minus Benchmark) divided by Benchmark times 100

CHALLENGE THRESHOLD:
If Deviation_Percent greater than 20 percent: Flag as aggressive
If Deviation_Percent greater than 50 percent: Flag as very aggressive, require justification

CONVERSION FUNNEL CALCULATION:
Conversions = Impressions times CTR times CVR
Required_Impressions = Target_Conversions divided by (CTR times CVR)
Required_Budget = Required_Impressions times CPM divided by 1000

10.3 STEP 3: BUDGET AND TIMELINE

DAILY BUDGET CALCULATION:
Daily_Budget = Total_Budget divided by Campaign_Days

PACING CHECK:
Daily_Required = Remaining_Budget divided by Remaining_Days
Pacing_Index = Actual_Daily_Spend divided by Daily_Required
If Pacing_Index less than 0.9: Underpacing
If Pacing_Index greater than 1.1: Overpacing

WORKING MEDIA PERCENTAGE:
Working_Media_Percent = (Budget minus Agency_Fees minus Tech_Fees minus Data_Fees) divided by Budget times 100
Minimum acceptable: 60 percent
Target: 70 percent or higher

10.4 STEP 4: AUDIENCE DEFINITION

ADDRESSABLE AUDIENCE CALCULATION:
Addressable_Audience = Total_Population times Demographic_Match_Rate times Behavioral_Match_Rate

AUDIENCE OVERLAP CALCULATION:
If Audience_A and Audience_B overlap:
Unique_Combined_Reach = Audience_A plus Audience_B minus (Audience_A times Audience_B divided by Total_Universe)

FREQUENCY DISTRIBUTION:
Using binomial distribution for n exposures:
P(k exposures) = C(n,k) times p raised to k times (1 minus p) raised to (n minus k)

10.5 STEP 5: CHANNEL STRATEGY

CHANNEL ALLOCATION FORMULA:
Channel_Budget = Total_Budget times Channel_Weight times Efficiency_Adjustment

EFFICIENCY ADJUSTMENT:
Based on response curve position:
If Marginal_ROI greater than Average: Weight up
If Marginal_ROI less than Average: Weight down

CROSS-CHANNEL REACH:
Combined_Reach = 1 minus Product of (1 minus Reach_i) for all channels i

10.6 STEP 6: PARTNER SELECTION

NET WORKING MEDIA (See SPO section):
NWM = Budget minus DSP_Fee minus SSP_Fee minus Verification_Fee minus Data_Fee minus Other_Fees

NET BENEFIT INDEX:
NBI = (Fee_Savings_Percent minus Quality_Impact_Percent) times Relevance_Weight

10.7 STEP 7: MEASUREMENT APPROACH

MINIMUM HOLDOUT SIZE:
For 95 percent confidence and 80 percent power:
Holdout_Size = 2.8 times (Variance divided by Effect_Size squared)

STATISTICAL SIGNIFICANCE:
Z_Score = (Test_Mean minus Control_Mean) divided by Standard_Error
If Z_Score greater than 1.96: Significant at 95 percent

10.8 STEP 8: OPTIMIZATION STRATEGY

OPTIMIZATION TRIGGER THRESHOLDS:
- CPM variance greater than 20 percent: Review creative or targeting
- CTR variance greater than 30 percent: Review creative
- CVR variance greater than 25 percent: Review landing page
- CPA variance greater than 15 percent: Review full funnel

10.9 STEP 9: COMPLIANCE AND BRAND SAFETY

VIEWABILITY ADJUSTMENT:
Effective_Impressions = Total_Impressions times Viewability_Rate
Adjusted_CPM = Paid_CPM divided by Viewability_Rate

FRAUD ADJUSTMENT:
Clean_Impressions = Total_Impressions times (1 minus IVT_Rate)
Adjusted_CPM = Paid_CPM divided by (1 minus IVT_Rate)

10.10 STEP 10: FINAL PROJECTION

FINAL PROJECTION FORMULA:
Projected_Outcome = Sum of (Channel_Contribution_i) for all channels
Where: Channel_Contribution_i = f(Spend_i, Response_Curve_i, Adstock_i, Seasonal_Factor)

CONFIDENCE INTERVAL:
Lower_Bound = Projection times (1 minus Uncertainty_Percent)
Upper_Bound = Projection times (1 plus Uncertainty_Percent)

SCENARIO COMPARISON:
Always present base case, optimistic, and conservative scenarios.

================================================================================
SECTION 11: CONFIDENCE LEVEL METHODOLOGY
================================================================================

11.1 CONFIDENCE LEVEL DEFINITIONS

HIGH CONFIDENCE:
- Source: Internal benchmarks validated by recent performance data
- Variance: Plus or minus 10 percent
- Criteria: Same vertical, same objective, same channels, within past 12 months

MEDIUM CONFIDENCE:
- Source: Industry benchmarks from authoritative sources
- Variance: Plus or minus 20 percent
- Criteria: Same vertical, similar objective, validated methodology

MEDIUM-LOW CONFIDENCE:
- Source: Cross-vertical extrapolation or dated benchmarks
- Variance: Plus or minus 30 percent
- Criteria: Related vertical or older than 18 months

LOW CONFIDENCE:
- Source: Web research, estimates, or limited data
- Variance: Plus or minus 40 percent or greater
- Criteria: Unvalidated or novel approach

11.2 CONFIDENCE ASSIGNMENT BY DATA TYPE

METRIC: CPM Projections
- Historical same campaign: HIGH
- Same vertical benchmark: MEDIUM
- Cross-vertical estimate: MEDIUM-LOW
- Web research: LOW

METRIC: CTR Projections
- Same creative type, same platform: HIGH
- Same platform, different creative: MEDIUM
- Different platform, similar format: MEDIUM-LOW
- New format or channel: LOW

METRIC: Conversion Rate Projections
- Same landing page, same audience: HIGH
- Same audience, new page: MEDIUM
- New audience: MEDIUM-LOW
- New vertical: LOW

METRIC: Total Conversions
- Based on HIGH confidence inputs: MEDIUM (compounding uncertainty)
- Based on MEDIUM inputs: MEDIUM-LOW
- Based on LOW inputs: LOW

11.3 CONFIDENCE COMMUNICATION

AGENT MUST ALWAYS:
- State confidence level for every projection
- Explain basis for confidence level
- Provide range, not just point estimate
- Offer to improve confidence with additional data

EXAMPLE OUTPUT:
"Based on vertical benchmarks (MEDIUM confidence), I project 1,500 conversions.
Range: 1,200 to 1,800 conversions (plus or minus 20 percent).
To improve confidence, I would need your historical campaign performance data."

================================================================================
SECTION 12: VALIDATION THRESHOLDS AND TRIGGERS
================================================================================

12.1 AUTOMATED VALIDATION TRIGGERS

The agent MUST automatically trigger validation when:

BUDGET TRIGGERS:
- Daily spend greater than 10 percent above plan: ALERT
- Weekly spend greater than 15 percent above plan: WARNING
- Daily spend less than 50 percent of plan: ALERT
- Working media less than 60 percent: WARNING

PERFORMANCE TRIGGERS:
- CPM greater than 130 percent of benchmark: INVESTIGATE
- CTR less than 50 percent of benchmark: INVESTIGATE
- CPA greater than 120 percent of target: WARNING
- ROAS less than 80 percent of target: WARNING

DELIVERY TRIGGERS:
- Impressions less than 80 percent of plan: ALERT
- Reach less than 70 percent of target: WARNING
- Frequency greater than 150 percent of cap: WARNING

12.2 PROACTIVE CHALLENGE TRIGGERS

The agent MUST challenge user inputs when:

CONVERSION TARGETS:
- Target CVR greater than 150 percent of vertical benchmark
- Target CPA less than 75 percent of vertical benchmark
- Target volume exceeds addressable audience capacity

BUDGET ALLOCATIONS:
- Single channel allocation greater than 60 percent of budget
- Channel allocation below minimum viable threshold
- Total programmatic greater than 30 percent (triggers SPO analysis)

TIMELINE EXPECTATIONS:
- Campaign shorter than 4 weeks
- Ramp-up period less than 2 weeks
- Conversion expectations during learning phase

12.3 GAP DETECTION THRESHOLDS

MINOR GAP (10 to 20 percent):
- Present as observation
- Offer optimization suggestions
- Continue with plan if user accepts

MODERATE GAP (20 to 35 percent):
- Present as concern
- Require acknowledgment
- Present 6 options framework

SIGNIFICANT GAP (greater than 35 percent):
- Present as critical issue
- Require resolution before proceeding
- Present 6 options framework with strong recommendations

================================================================================
SECTION 13: FORMULA QUICK REFERENCE
================================================================================

13.1 EFFICIENCY FORMULAS

CPM = (Total_Spend divided by Impressions) times 1000
CPC = Total_Spend divided by Clicks
CPA = Total_Spend divided by Conversions
CAC = Total_Spend divided by New_Customers
ROAS = Revenue divided by Total_Spend
ROI = (Revenue minus Spend) divided by Spend times 100
LTV_to_CAC = Customer_Lifetime_Value divided by CAC

13.2 DELIVERY FORMULAS

CTR = (Clicks divided by Impressions) times 100
CVR = (Conversions divided by Clicks) times 100
Conversion_Rate = (Conversions divided by Sessions) times 100
GRPs = Reach_Percent times Frequency
Reach = Unique_Users divided by Target_Audience times 100
Frequency = Impressions divided by Unique_Users
Effective_Frequency_Index = Actual_Frequency divided by Target_Frequency

13.3 BUDGET FORMULAS

Working_Media_Percent = (Budget minus All_Fees) divided by Budget times 100
Net_Working_Media = Budget times Working_Media_Percent
Daily_Budget = Total_Budget divided by Campaign_Days
Required_Budget = (Target_Conversions times Target_CPA)
Budget_Gap = Required_Budget minus Actual_Budget

13.4 PROJECTION FORMULAS

Projected_Impressions = Budget times 1000 divided by CPM
Projected_Clicks = Projected_Impressions times CTR divided by 100
Projected_Conversions = Projected_Clicks times CVR divided by 100
Projected_Revenue = Projected_Conversions times AOV
Projected_CAC = Budget divided by Projected_Conversions

13.5 VARIANCE FORMULAS

Variance_Percent = (Actual minus Planned) divided by Planned times 100
Pacing_Index = Actual_Spend divided by Expected_Spend
Performance_Index = Actual_Conversions divided by Expected_Conversions

13.6 RFM ANALYSIS FORMULAS

Recency = Today_Date minus Last_Purchase_Date (days)
Frequency = Count of Transactions in Period
Monetary = Sum of Transaction Values in Period
RFM_Score = R_Score concatenated with F_Score concatenated with M_Score
RFM_Total = R_Score plus F_Score plus M_Score
Weighted_RFM = (W_R times R) plus (W_F times F) plus (W_M times M)
Quintile_Rank = NTILE(5) over (ORDER BY Metric)

13.7 LIFETIME VALUE FORMULAS

Simple_LTV = Average_Revenue_Per_Customer times Customer_Lifespan
Traditional_CLV = (Margin times Retention) divided by (1 plus Discount_Rate minus Retention)
LTV_to_CAC = Customer_Lifetime_Value divided by Customer_Acquisition_Cost
CAC_Payback_Months = CAC divided by Monthly_Margin_Per_Customer
Expected_Purchases = BG_NBD_Model(Frequency, Recency, T)
P_Alive = Probability_Customer_Active(Frequency, Recency, T)

13.8 DECILE AND BREAKEVEN FORMULAS

Lift_Decile = Response_Rate_Decile divided by Overall_Response_Rate
Cumulative_Lift = Cumulative_Response_Rate divided by Overall_Response_Rate
Breakeven_Response = Cost_Per_Piece divided by (Profit_Per_Response times Margin)
Profit_Decile = (Responders times Profit) minus (Customers times Cost)
Marginal_ROI = Change_in_Revenue divided by Change_in_Spend

13.9 COHORT ANALYSIS FORMULAS

Retention_Rate_t = Active_Customers_t divided by Original_Cohort_Size
Survival_Function = Product of (1 minus Churn_Rate_i) for i = 1 to t
Cohort_LTV = Sum of (Retention_t times ARPU_t times Discount_t) for t = 1 to n
Churn_Rate = Churned_Customers divided by Starting_Customers
Average_Customer_Lifespan = 1 divided by Churn_Rate

13.10 STATISTICAL TESTING FORMULAS

Sample_Size = 2 times p times (1 minus p) times ((Z_alpha plus Z_beta) divided by MDE)^2
Statistical_Power = 1 minus Beta
MDE = (Z_alpha plus Z_beta) times sqrt(2 times Variance divided by n)
Standard_Error = sqrt(p times (1 minus p) divided by n)
Confidence_Interval = Point_Estimate plus/minus (Z times Standard_Error)
Bonferroni_Alpha = Alpha divided by Number_of_Tests
Chi_Square_SRM = Sum of ((Observed minus Expected)^2 divided by Expected)

================================================================================
SECTION 14: RFM ANALYSIS FUNDAMENTALS
================================================================================

14.1 RFM DEFINITION AND PURPOSE

RFM (Recency, Frequency, Monetary) analysis is a proven marketing technique for behavior-based customer segmentation. First introduced by Hughes (1994) and formalized by Bult and Wansbeek (1995), RFM originated in direct mail and catalog marketing to optimize targeting decisions.

RFM groups customers based on three quantifiable transaction behaviors:

RECENCY (R):
How recently did the customer make a purchase?
Measured as days since last transaction.
Customers who purchased recently are more likely to respond to marketing.

FREQUENCY (F):
How often does the customer make purchases?
Measured as number of transactions in a defined period.
Frequent buyers demonstrate loyalty and engagement.

MONETARY (M):
How much does the customer spend?
Measured as total revenue or average order value.
High spenders represent greater customer value.

PURPOSE OF RFM:
- Identify most valuable customers (Champions)
- Segment customers for targeted marketing
- Predict future purchase likelihood
- Optimize marketing budget allocation
- Reduce wasted spend on unresponsive segments
- Provide inputs for probabilistic LTV models (BG/NBD, Pareto/NBD)

14.2 CALCULATING RFM VALUES

RAW RFM CALCULATIONS:

For each customer, calculate:

Recency_Value = Today_Date minus Last_Purchase_Date (in days)
Frequency_Value = Count of distinct transactions in analysis period
Monetary_Value = Sum of transaction values in analysis period

ANALYSIS PERIOD:
- Typically 12-24 months of transaction history
- Shorter periods (6 months) for high-frequency businesses
- Longer periods (36 months) for low-frequency purchases

EXAMPLE CALCULATION:
Customer ID: 12345
Last Purchase: 15 days ago
Transactions in 12 months: 8
Total Spend in 12 months: $1,250

Recency = 15 days
Frequency = 8 transactions
Monetary = $1,250

14.3 RFM SCORING METHODOLOGY

Each customer receives a score of 1 to 5 for each RFM component, where 5 is best and 1 is worst.

SCORING METHOD 1: QUINTILES (Recommended)

Divide customers into 5 equal groups (20 percent each) based on each metric.

PROCESS:
- Rank all customers by Recency (ascending - lower days is better)
- Assign top 20 percent a score of 5, next 20 percent a score of 4, etc.
- Repeat for Frequency (descending - higher is better)
- Repeat for Monetary (descending - higher is better)

QUINTILE ADVANTAGE:
- Automatically adjusts to your data distribution
- Works across all industries and business models
- Distributes customers evenly across scores

SCORING METHOD 2: FIXED RANGES

Define specific thresholds based on business knowledge.

EXAMPLE FIXED RANGES FOR RECENCY:
- Score 5: Purchase within last 7 days
- Score 4: Purchase within last 30 days
- Score 3: Purchase within last 90 days
- Score 2: Purchase within last 180 days
- Score 1: Purchase more than 180 days ago

EXAMPLE FIXED RANGES FOR FREQUENCY (Annual):
- Score 5: 12 or more purchases
- Score 4: 6-11 purchases
- Score 3: 3-5 purchases
- Score 2: 2 purchases
- Score 1: 1 purchase

FIXED RANGE CONSIDERATIONS:
- Requires business-specific calibration
- May need adjustment as business grows
- Can create uneven segment sizes

14.4 COMBINING RFM SCORES

CONCATENATION METHOD:
Combine three scores into a single RFM code.
RFM_Code = R_Score concatenated with F_Score concatenated with M_Score

EXAMPLE:
R_Score = 5, F_Score = 4, M_Score = 3
RFM_Code = "543"

This creates 125 possible combinations (5 x 5 x 5).

ADDITION METHOD:
Sum the three scores for a single composite score.
RFM_Total = R_Score plus F_Score plus M_Score

EXAMPLE:
R_Score = 5, F_Score = 4, M_Score = 3
RFM_Total = 12

Range: 3 (minimum) to 15 (maximum)

WEIGHTED SCORING:
Apply different weights based on business priorities.
Weighted_RFM = (W_R times R_Score) plus (W_F times F_Score) plus (W_M times M_Score)

EXAMPLE WEIGHTS:
- Subscription business: Weight Frequency higher
- Luxury retail: Weight Monetary higher
- Perishable goods: Weight Recency higher

14.5 STANDARD RFM CUSTOMER SEGMENTS

Based on RFM score combinations, customers are classified into actionable segments.

CHAMPIONS (R: 5, F: 4-5, M: 4-5):
- Best customers
- Bought recently, buy often, spend the most
- Action: Reward loyalty, offer early access, ask for reviews

LOYAL CUSTOMERS (R: 3-4, F: 4-5, M: 4-5):
- Consistent high-value buyers
- May not have purchased very recently
- Action: Upsell premium products, loyalty program

POTENTIAL LOYALISTS (R: 4-5, F: 2-3, M: 2-3):
- Recent customers with growth potential
- Bought recently but not frequently yet
- Action: Onboarding, cross-sell, build relationship

NEW CUSTOMERS (R: 5, F: 1, M: 1-2):
- Just made first purchase
- Unknown long-term potential
- Action: Welcome series, education, second purchase incentive

PROMISING (R: 3-4, F: 1-2, M: 1-2):
- Recent one-time buyers
- Need nurturing to develop
- Action: Build awareness, offer incentives

NEEDS ATTENTION (R: 2-3, F: 2-3, M: 2-3):
- Average customers showing decline
- Engagement dropping
- Action: Reactivation campaigns, surveys

AT RISK (R: 1-2, F: 3-4, M: 3-4):
- Previously valuable, now disengaging
- High priority for retention
- Action: Win-back campaigns, personal outreach

CANNOT LOSE THEM (R: 1-2, F: 4-5, M: 4-5):
- Formerly best customers, now inactive
- Critical to recover
- Action: Aggressive win-back, understand why they left

HIBERNATING (R: 1-2, F: 1-2, M: 1-2):
- Low value, inactive
- May not be worth significant investment
- Action: Low-cost reactivation or deprioritize

LOST (R: 1, F: 1, M: 1):
- Lowest scores across all dimensions
- Likely churned permanently
- Action: Remove from active marketing, occasional reactivation

14.6 RFM SEGMENTATION VISUALIZATION

TWO-DIMENSIONAL RFM MATRIX:

To simplify 125 combinations, create a 2D matrix:
- X-axis: Recency Score (1-5)
- Y-axis: Combined Frequency plus Monetary Score (2-10, or averaged 1-5)

This reduces to approximately 25-50 viewable cells.

SEGMENT MAPPING EXAMPLE:

High F+M, High R (top right): Champions, Loyal
High F+M, Low R (top left): At Risk, Cannot Lose
Low F+M, High R (bottom right): New, Promising
Low F+M, Low R (bottom left): Hibernating, Lost

RFM HEATMAP:
Color-code cells by customer count or revenue contribution.
Darker colors indicate higher concentration or value.

14.7 RFM VARIATIONS

RFE (Recency, Frequency, Engagement):
For businesses without direct monetary transactions.
Replace Monetary with engagement metrics:
- Time on site
- Pages viewed
- Features used
- Content consumed

RFD (Recency, Frequency, Duration):
For attention-based businesses.
Replace Monetary with session duration or viewing time.

RFM-I (Adding Interaction):
Add fourth dimension for customer interactions:
- Support tickets
- Email opens
- Social engagement

WEIGHTED RFM:
Adjust component weights based on predictive power.
Use regression analysis to determine optimal weights.

14.8 RFM AND PROBABILISTIC LTV MODELS

RFM data provides the required inputs for probabilistic CLV models.

BG/NBD MODEL INPUTS:
- Frequency: Number of repeat purchases (total minus one)
- Recency: Time since most recent purchase (in periods)
- T: Customer age since first purchase (in periods)

PARETO/NBD MODEL INPUTS:
Same as BG/NBD but models continuous dropout.

GAMMA-GAMMA MODEL INPUTS:
- Monetary: Average transaction value per customer
- Frequency: Number of transactions (for weighting)

DATA PREPARATION FOR CLV MODELS:

From RFM data, derive:
- x = Frequency minus 1 (repeat purchases only)
- t_x = Recency in time units (weeks, months)
- T = Customer age in same time units
- m_x = Average monetary value per transaction

14.9 PRACTICAL RFM IMPLEMENTATION

STEP 1: DATA EXTRACTION
Pull transaction data with:
- Customer ID
- Transaction date
- Transaction amount
- Order ID (for frequency counting)

STEP 2: CALCULATE RAW VALUES
For each customer:
- Days since last purchase
- Count of distinct orders
- Sum of order values

STEP 3: ASSIGN SCORES
Using quintiles or fixed ranges, score each dimension 1-5.

STEP 4: CREATE SEGMENTS
Map RFM codes to named segments.

STEP 5: VALIDATE SEGMENTS
Check segment sizes and characteristics.
Ensure segments are actionable and distinct.

STEP 6: ACTIVATE SEGMENTS
Deploy segments to:
- Email marketing platforms
- Advertising audiences
- CRM systems
- Personalization engines

REFRESH FREQUENCY:
- Daily: High-frequency e-commerce
- Weekly: Standard retail
- Monthly: Subscription businesses
- Quarterly: Low-frequency purchases

14.10 AGENT GUIDANCE FOR RFM

WHEN TO RECOMMEND RFM:
- Client has transaction history data
- Need to prioritize customer segments
- Planning retention or reactivation campaigns
- Evaluating customer quality by acquisition source

RFM BENCHMARKS:
- Champions should represent 5-15 percent of customers
- At Risk segment requires immediate attention if growing
- Lost segment exceeding 20 percent indicates retention problem

INTEGRATION WITH MEDIA PLANNING:
- Use RFM segments for audience targeting
- Exclude Lost customers from prospecting lookalikes
- Build Champions lookalikes for acquisition
- Allocate retention budget based on At Risk segment size

LIMITATIONS:
- Does not account for product category differences
- May not capture engagement outside purchases
- Requires sufficient transaction history
- Scores are relative to your customer base only

================================================================================
SECTION 15: CUSTOMER LIFETIME VALUE MODELS
================================================================================

15.1 LTV DEFINITION AND IMPORTANCE

Customer Lifetime Value (CLV or LTV) represents the total revenue a business expects from a customer throughout their entire relationship. LTV is the theoretical maximum a company should pay to acquire a customer.

CORE LTV FORMULA (Simple):
LTV = Average_Revenue_Per_Customer times Customer_Lifespan

MARGIN-ADJUSTED LTV:
LTV = (Average_Order_Value times Purchase_Frequency times Customer_Lifespan) times Gross_Margin

DISCOUNTED LTV (Net Present Value):
LTV = Sum of (Margin_t divided by (1 plus Discount_Rate) to power t) for t = 1 to Lifespan

15.2 DETERMINISTIC LTV MODELS

HISTORICAL CLV:
Based on actual past revenue from customer relationships.
Formula: Historical_CLV = Sum of all past transactions minus acquisition and service costs

TRADITIONAL CLV (With Retention and Discounting):
Formula: CLV = (GML times R) divided by (1 plus D minus R)

Where:
- GML = Gross Margin per Lifespan (average margin per customer)
- R = Retention Rate (percentage of customers retained per period)
- D = Discount Rate (cost of capital)

EXAMPLE CALCULATION:
- Average monthly margin per customer: $100
- Monthly churn rate: 5 percent
- Retention rate: 95 percent
- Discount rate: 10 percent annually (0.83 percent monthly)

CLV = ($100 times 0.95) divided by (1 plus 0.0083 minus 0.95)
CLV = $95 divided by 0.0583
CLV = $1,630

CONTRACTUAL SETTING LTV:
For subscription businesses with defined contract periods.
Formula: Contractual_CLV = Sum of (Monthly_Revenue times Retention_Rate_t times Discount_Factor_t) for t = 1 to n

15.3 PROBABILISTIC LTV MODELS

These models are essential for non-contractual settings where customer dropout is not observable.

BG/NBD MODEL (Beta-Geometric/Negative Binomial Distribution):
Developed by Fader, Hardie, and Lee (2005). Used for non-contractual continuous purchase settings.

MODEL ASSUMPTIONS:
- While active, customer purchases follow a Poisson process with rate lambda
- Purchase rate lambda varies across customers (Gamma distribution)
- After any transaction, customer may become inactive with probability p
- Dropout probability p varies across customers (Beta distribution)

KEY INPUTS (RFM Framework):
- Frequency: Number of repeat purchases (total minus one)
- Recency: Time since most recent purchase
- T: Customer age (time since first purchase)

KEY OUTPUTS:
- Expected number of future purchases
- Probability customer is still active
- Conditional expected purchases given customer history

PARETO/NBD MODEL:
Similar to BG/NBD but assumes dropout can occur at any time, not just after purchases. More complex but sometimes more accurate for certain business types.

MODEL PARAMETERS:
- r, alpha: Shape and scale for transaction rate heterogeneity
- s, beta: Shape and scale for dropout rate heterogeneity

GAMMA-GAMMA MODEL:
Used in conjunction with BG/NBD or Pareto/NBD to model monetary value.

FORMULA:
E[M given x, mx] = (q times mx plus p times M_bar) divided by (q plus p)

Where:
- x = number of transactions
- mx = average transaction value for customer
- M_bar = average transaction value across all customers
- p, q = model parameters

COMBINED CLV CALCULATION:
CLV = E[Purchases in Period t] times E[Monetary Value] times Margin times Discount_Factor

15.4 LTV CALCULATION FRAMEWORK BY BUSINESS TYPE

CONTRACTUAL BUSINESSES (Subscriptions):
- Use survival analysis or simple retention curves
- Calculate probability of renewal at each period
- Sum expected discounted cash flows

FORMULA:
CLV = Sum of (Monthly_Revenue times Survival_Prob_t times (1 divided by (1 plus r))^t)

NON-CONTRACTUAL CONTINUOUS (E-commerce, Retail):
- Use BG/NBD or Pareto/NBD for purchase frequency
- Use Gamma-Gamma for monetary value
- Combine with discount factor

NON-CONTRACTUAL DISCRETE (Periodic Events):
- Use BG/BB (Beta-Geometric/Beta-Binomial) model
- Appropriate for annual events like donations, conferences

15.5 LTV TO CAC RATIO

The LTV to CAC ratio determines acquisition efficiency and business sustainability.

CALCULATION:
LTV_to_CAC = Customer_Lifetime_Value divided by Customer_Acquisition_Cost

INTERPRETATION THRESHOLDS:

RATIO LESS THAN 1:0:
- Losing money on every customer
- Unsustainable business model
- Immediate action required

RATIO 1:1 TO 2:1:
- Marginally profitable
- Limited room for error
- Consider improving retention or reducing CAC

RATIO 2:1 TO 3:1:
- Healthy business
- Room for growth investment
- Standard target for most businesses

RATIO 3:1 TO 5:1:
- Strong unit economics
- Opportunity to invest more in acquisition
- May be underinvesting in growth

RATIO GREATER THAN 5:1:
- Excellent economics
- Consider aggressive growth investment
- Evaluate if underinvesting in acquisition

PAYBACK PERIOD:
CAC_Payback_Months = CAC divided by Monthly_Margin_Per_Customer
Target: Less than 12 months for healthy businesses

15.6 AGENT GUIDANCE FOR LTV

WHEN TO USE SIMPLE LTV:
- Quick estimates during early planning
- Limited historical data available
- Contractual business with stable retention

WHEN TO USE PROBABILISTIC LTV:
- Non-contractual settings
- Significant customer heterogeneity
- Need for individual-level predictions

REQUIRED DATA FOR BG/NBD:
- Customer-level transaction history
- First purchase date per customer
- All subsequent purchase dates
- Minimum 6-12 months of history recommended

VALIDATION:
- Compare predicted future purchases to actual for holdout cohorts
- Calculate prediction error across deciles
- Re-estimate parameters quarterly

================================================================================
SECTION 16: DECILE ANALYSIS AND MARGINAL OPTIMIZATION
================================================================================

16.1 DECILE ANALYSIS FUNDAMENTALS

Decile analysis divides customers or prospects into ten equal groups ranked by a predicted outcome (response probability, value, etc.). This technique originated in direct mail and catalog marketing to optimize targeting decisions.

PURPOSE:
- Identify most responsive customer segments
- Determine optimal depth of marketing investment
- Calculate breakeven points for campaigns
- Allocate marketing dollars efficiently

16.2 CONSTRUCTING A DECILE TABLE

PROCESS:
- Build predictive model (logistic regression, ML model)
- Score all customers with predicted probability
- Rank customers from highest to lowest probability
- Divide into 10 equal groups (deciles)
- Calculate metrics for each decile

STANDARD DECILE TABLE METRICS:

For each decile calculate:
- Number of customers
- Number of responders
- Response rate (responders divided by customers)
- Cumulative responders
- Cumulative response rate
- Lift (decile response rate divided by overall rate)
- Cumulative lift

EXAMPLE DECILE TABLE:

Decile 1 (Top 10 percent):
- Customers: 1,000
- Responders: 224
- Response Rate: 22.4 percent
- Cumulative Responders: 224
- Lift: 2.28x

Decile 2:
- Customers: 1,000
- Responders: 161
- Response Rate: 16.1 percent
- Cumulative Responders: 385
- Lift: 1.96x (cumulative)

Continue through Decile 10...

Overall response rate in example: 9.83 percent
Top decile captures 22.8 percent of all responders

16.3 GAINS CHART AND LIFT CHART

GAINS CHART (Cumulative Response Curve):
Plots cumulative percent of responders captured vs. percent of population contacted.

INTERPRETATION:
- Curve above diagonal indicates model has predictive power
- Steeper curve indicates better model performance
- Perfect model would be vertical then horizontal

LIFT CHART:
Plots lift factor for each decile.

CALCULATION:
Lift_Decile = Response_Rate_Decile divided by Overall_Response_Rate

CUMULATIVE LIFT:
Cumulative_Lift = Cumulative_Response_Rate divided by Overall_Response_Rate

16.4 BREAKEVEN ANALYSIS FOR DIRECT MARKETING

BREAKEVEN RESPONSE RATE:
The minimum response rate required to recover campaign costs.

FORMULA:
Breakeven_Response_Rate = Cost_Per_Piece divided by (Profit_Per_Response times Net_Contribution_Margin)

EXAMPLE:
- Cost per piece mailed: $0.75
- Average order value: $80
- Net contribution margin: 65 percent
- Profit per response: $80 times 0.65 = $52

Breakeven = $0.75 divided by $52 = 1.44 percent

BREAKEVEN DEPTH DETERMINATION:
Using decile table, determine how deep into the file to mail:
- Mail all deciles where response rate exceeds breakeven
- Stop at decile where expected response equals breakeven

MAXIMUM PROFIT POINT:
Not necessarily the same as breakeven depth.

FORMULA:
Profit_Decile = (Responders times Profit_Per_Response) minus (Customers times Cost_Per_Piece)

Total_Profit = Sum of Profit_Decile for all mailed deciles
Optimal depth is where marginal profit of next decile approaches zero.

16.5 MARGINAL DOLLAR ALLOCATION PRINCIPLE

CORE CONCEPT:
Allocate each marketing dollar to the opportunity with the highest marginal return. Stop when marginal return equals marginal cost.

MARGINAL ROI CALCULATION:
Marginal_ROI = Change_in_Revenue divided by Change_in_Spend

OPTIMIZATION RULE:
Continue investing in a channel until:
Marginal_Revenue = Marginal_Cost

Or equivalently:
Marginal_ROI = 1.0

CROSS-CHANNEL OPTIMIZATION:
At optimum, marginal ROI should be equal across all channels:
Marginal_ROI_Channel_A = Marginal_ROI_Channel_B = ... = Marginal_ROI_Channel_N

If not equal, reallocate from lower marginal ROI channels to higher ones.

16.6 APPLYING DECILE LOGIC TO BUDGET ALLOCATION

CHANNEL DECILE APPROACH:
- Estimate response curve for each channel
- Calculate marginal return at current spend level
- Rank investment opportunities by marginal return
- Allocate budget to highest marginal return opportunities first
- Continue until budget exhausted or marginal returns equalize

DIMINISHING RETURNS INTEGRATION:
Use response curve models from Section 5 to estimate marginal returns at different spend levels.

FORMULA:
Marginal_Return = dResponse divided by dSpend = First derivative of response curve

For Hill function:
Marginal_Return = Saturation times Alpha times K^Alpha times Spend^(Alpha minus 1) divided by (K^Alpha plus Spend^Alpha)^2

16.7 PRACTICAL DEPTH-OF-FILE DECISIONS

CONSERVATIVE APPROACH:
Mail to breakeven depth minus one decile for safety margin.

AGGRESSIVE APPROACH:
Mail to maximum profit depth.

TESTING APPROACH:
Test deeper deciles with smaller quantities to validate model predictions.

N-TH SELECT TESTING:
When testing lists or segments:
- Use N-th name selection (every Nth record)
- Ensures representative sample of file
- Typical test: 5,000 to 10,000 names per segment
- Roll out based on test results

AGENT GUIDANCE:
- Always calculate breakeven before recommending campaign depth
- Present decile analysis to justify targeting decisions
- Monitor actual response vs. predicted by decile
- Adjust models based on campaign performance

================================================================================
SECTION 17: COHORT AND VINTAGE ANALYSIS
================================================================================

17.1 COHORT ANALYSIS FUNDAMENTALS

Cohort analysis groups customers by a shared characteristic (typically acquisition date) and tracks their behavior over time. This enables apples-to-apples comparison across different time periods.

COHORT TYPES:

ACQUISITION COHORTS:
Grouped by when customer was acquired (first purchase date, signup date).
Best for understanding customer lifecycle patterns.

BEHAVIORAL COHORTS:
Grouped by specific actions taken (feature adoption, purchase category).
Best for understanding feature impact on retention.

TIME-BASED COHORTS:
Grouped by calendar time period.
Best for understanding market trends and seasonality.

17.2 RETENTION MATRIX CONSTRUCTION

The retention matrix is the foundation of cohort LTV analysis.

STRUCTURE:
- Rows: Acquisition cohorts (by month, quarter, or year)
- Columns: Tenure periods (months since acquisition)
- Cells: Retention rate or customer count

EXAMPLE RETENTION MATRIX (Retention Rates):

Cohort Jan 2024: Month 0 = 100 percent, Month 1 = 45 percent, Month 2 = 38 percent, Month 3 = 34 percent, Month 6 = 28 percent, Month 12 = 22 percent
Cohort Feb 2024: Month 0 = 100 percent, Month 1 = 47 percent, Month 2 = 40 percent, Month 3 = 36 percent, Month 6 = 29 percent
Cohort Mar 2024: Month 0 = 100 percent, Month 1 = 44 percent, Month 2 = 37 percent, Month 3 = 33 percent
Cohort Apr 2024: Month 0 = 100 percent, Month 1 = 46 percent, Month 2 = 39 percent

CALCULATING RETENTION:
Retention_Rate_t = Active_Customers_t divided by Original_Cohort_Size

SURVIVAL FUNCTION:
S(t) = Probability customer survives to time t
S(t) = Product of (1 minus Churn_Rate_i) for i = 1 to t

17.3 RETENTION CURVE MODELING

RETENTION CURVE PATTERNS:

EXPONENTIAL DECAY:
Retention(t) = exp(minus lambda times t)
Constant churn rate each period.

POWER LAW DECAY:
Retention(t) = t^(minus alpha)
Churn rate decreases over time (common in practice).

LOGARITHMIC CURVE:
Retention(t) = a times ln(t) plus b
Good for mature cohorts with stable tail retention.

SHIFTED BETA-GEOMETRIC:
Accounts for heterogeneous churn rates across customer segments.
Results in faster early churn, slower late churn.

17.4 FIVE-YEAR LIFECYCLE FORECASTING

FORECASTING METHODOLOGY:

STEP 1: ESTABLISH HISTORICAL BASELINE
- Analyze 2-3 years of cohort data minimum
- Identify mature cohort retention curves
- Calculate average retention curve across cohorts

STEP 2: FIT RETENTION MODEL
- Select appropriate curve type (exponential, power law, logarithmic)
- Fit model parameters to historical data
- Validate fit with holdout cohorts

STEP 3: PROJECT RETENTION CURVE
- Extend model forward 60 months (5 years)
- Account for curve flattening at long tenure
- Apply confidence intervals to projections

STEP 4: OVERLAY REVENUE/VALUE
- Apply average revenue per active customer by tenure
- Account for revenue trends by tenure (upsell, cross-sell)
- Calculate cumulative LTV curve

FIVE-YEAR PROJECTION TEMPLATE:

Year 1:
- Month 1-3: Acquisition and onboarding (high churn)
- Month 4-12: Stabilization (moderate churn)
- Year 1 Survival Estimate: 20-35 percent typical

Year 2:
- Month 13-24: Retention normalization
- Churn rate typically stabilizes
- Year 2 Survival Estimate: 15-25 percent (of original)

Year 3-5:
- Month 25-60: Mature customer base
- Low, stable churn rates
- Year 5 Survival Estimate: 8-18 percent (of original)

17.5 COHORT LTV CALCULATION

FORMULA:
Cohort_LTV = Sum of (Retention_Rate_t times ARPU_t times Discount_Factor_t) for t = 1 to 60

MONTHLY CALCULATION:
For each month t:
- Expected_Active = Original_Cohort_Size times Retention_Rate_t
- Expected_Revenue_t = Expected_Active times ARPU_t
- Discounted_Revenue_t = Expected_Revenue_t divided by (1 plus monthly_rate)^t

YEARLY AGGREGATION:
Year_1_LTV = Sum of monthly LTV for months 1-12
Year_2_LTV = Sum of monthly LTV for months 13-24
... through Year 5

17.6 VINTAGE ANALYSIS FOR ACQUISITION QUALITY

Vintage analysis compares cohorts to assess whether acquisition quality is improving or declining.

KEY VINTAGE METRICS:

RETENTION BENCHMARK:
Compare new cohort retention at Month 3, Month 6, Month 12 to historical average.
Declining retention signals acquisition quality issues.

LTV VELOCITY:
Track LTV accumulation rate by cohort.
Slower LTV accumulation indicates lower quality customers.

PAYBACK TRAJECTORY:
Track CAC payback timing by cohort.
Lengthening payback indicates declining cohort quality.

RED FLAGS:
- Retention at Month 6 declining cohort-over-cohort
- LTV to CAC ratio declining
- Payback period extending beyond 12 months

17.7 APPLYING COHORT ANALYSIS TO PLANNING

AGENT APPLICATIONS:

ACQUISITION PLANNING:
- Project new customer LTV based on recent cohort performance
- Calculate maximum acceptable CAC from cohort LTV
- Recommend budget based on target customer volume

RETENTION PLANNING:
- Identify tenure points with highest churn
- Recommend intervention timing based on cohort data
- Project impact of retention improvements on LTV

FORECASTING:
- Build revenue forecasts from cohort projections
- Account for acquisition pipeline and retention
- Model scenarios with different acquisition/retention assumptions

QUARTERLY AND MONTHLY BREAKDOWNS:

QUARTERLY VIEW:
- Q1: Cohorts from Q4 prior year entering stabilization
- Q2-Q3: Full-year cohorts maturing
- Q4: Assess full lifecycle of year-old cohorts

MONTHLY VIEW:
- Track month-over-month retention changes
- Identify seasonal patterns in retention
- Adjust projections for seasonality

================================================================================
SECTION 18: ADVANCED STATISTICAL FRAMEWORK
================================================================================

18.1 STATISTICAL SIGNIFICANCE FUNDAMENTALS

Statistical significance determines whether observed differences are likely real or due to random chance.

KEY CONCEPTS:

NULL HYPOTHESIS (H0):
There is no difference between test and control groups.
Default assumption until evidence proves otherwise.

ALTERNATIVE HYPOTHESIS (H1):
There is a meaningful difference between groups.
What we are trying to prove.

P-VALUE:
Probability of observing results at least as extreme as actual results, assuming null hypothesis is true.

INTERPRETATION:
- p less than 0.05: Statistically significant (95 percent confidence)
- p less than 0.01: Highly significant (99 percent confidence)
- p less than 0.10: Marginally significant (90 percent confidence)

18.2 TYPE I AND TYPE II ERRORS

TYPE I ERROR (False Positive):
- Rejecting null hypothesis when it is true
- Claiming a difference exists when it does not
- Probability = Alpha (typically 0.05 or 5 percent)

TYPE II ERROR (False Negative):
- Failing to reject null hypothesis when it is false
- Missing a real difference
- Probability = Beta (typically 0.20 or 20 percent)

RELATIONSHIP:
- Reducing Type I error increases Type II error (and vice versa)
- Must balance based on business consequences
- False positives waste resources on ineffective changes
- False negatives miss valuable improvements

18.3 STATISTICAL POWER

DEFINITION:
Power = 1 minus Beta = Probability of detecting a true effect when it exists

STANDARD TARGET:
80 percent power is conventional minimum (20 percent false negative rate)
90 percent power for high-stakes decisions

POWER DEPENDS ON:
- Sample size (larger = more power)
- Effect size (larger effects easier to detect)
- Significance level alpha (lower alpha = lower power)
- Variance in data (less variance = more power)

POWER CALCULATION FORMULA:
For two-sample comparison:
n = 2 times ((Z_alpha plus Z_beta) divided by Effect_Size)^2 times Variance

Where:
- Z_alpha = 1.96 for 95 percent confidence (one-sided: 1.645)
- Z_beta = 0.84 for 80 percent power
- Effect_Size = Expected difference divided by Standard deviation

18.4 MINIMUM DETECTABLE EFFECT (MDE)

DEFINITION:
The smallest effect size that can be reliably detected given sample size and power requirements.

FORMULA:
MDE = (Z_alpha plus Z_beta) times sqrt(2 times Variance divided by n)

PRACTICAL INTERPRETATION:
- If MDE is 10 percent and true effect is 5 percent, test will likely miss it
- Choose sample size to achieve MDE smaller than expected effect

MDE TARGETS BY CONTEXT:

CONVERSION RATE TESTS:
- MDE of 5-10 percent relative lift typical
- Requires thousands to tens of thousands of conversions

REVENUE TESTS:
- Higher variance requires larger samples
- MDE of 2-5 percent often achievable

ENGAGEMENT TESTS:
- Lower variance allows smaller MDE
- MDE of 1-3 percent often achievable

18.5 SAMPLE SIZE CALCULATION

FOR CONVERSION RATE TESTS:
n_per_group = 2 times p times (1 minus p) times ((Z_alpha plus Z_beta) divided by MDE)^2

EXAMPLE:
- Baseline conversion rate: 3 percent
- Desired MDE: 10 percent relative (0.3 percent absolute)
- 95 percent confidence, 80 percent power

n = 2 times 0.03 times 0.97 times ((1.96 plus 0.84) divided by 0.003)^2
n = approximately 50,699 per group
Total sample needed: approximately 101,400

FOR REVENUE TESTS:
Higher variance requires larger adjustment.
Rule of thumb: 2-4x conversion test sample sizes.

18.6 CONFIDENCE INTERVALS

DEFINITION:
Range within which true parameter value likely falls with specified probability.

95 PERCENT CONFIDENCE INTERVAL:
CI = Point_Estimate plus/minus (1.96 times Standard_Error)

FOR PROPORTIONS:
SE = sqrt(p times (1 minus p) divided by n)
CI = p plus/minus 1.96 times sqrt(p times (1 minus p) divided by n)

FOR DIFFERENCES:
SE_diff = sqrt(SE_1^2 plus SE_2^2)
CI_diff = (p1 minus p2) plus/minus 1.96 times SE_diff

INTERPRETATION:
If confidence interval for difference includes zero, difference is not statistically significant.

18.7 BAYESIAN VS. FREQUENTIST APPROACHES

FREQUENTIST (Traditional):
- Fixed parameters, random samples
- P-values and confidence intervals
- Requires pre-specified sample size
- Binary significant/not significant decisions

BAYESIAN:
- Parameters have probability distributions
- Updates beliefs based on evidence
- Can stop early with sufficient confidence
- Probability of one variant being better

BAYESIAN METRICS:
- Probability to Beat Control: P(B greater than A)
- Expected Loss: Expected value of choosing wrong variant
- Credible Interval: Bayesian analog to confidence interval

WHEN TO USE BAYESIAN:
- Want probability statements about variants
- Need flexibility in stopping rules
- Have prior information to incorporate
- Prefer continuous monitoring

18.8 MULTIPLE TESTING CORRECTIONS

PROBLEM:
Testing multiple metrics increases false positive rate.
With 20 metrics at alpha = 0.05, expect 1 false positive.

BONFERRONI CORRECTION:
Adjusted_Alpha = Alpha divided by Number_of_Tests

EXAMPLE:
Testing 5 metrics at 95 percent confidence:
Adjusted_Alpha = 0.05 divided by 5 = 0.01
Require p less than 0.01 for significance.

FALSE DISCOVERY RATE (FDR):
Benjamini-Hochberg procedure controls expected proportion of false positives among significant results.
Less conservative than Bonferroni.

HIERARCHICAL TESTING:
- Test primary metric first without adjustment
- Only test secondary metrics if primary is significant
- Apply correction only to secondary metrics

18.9 VALIDATION METHODOLOGY

PRE-TEST VALIDATION:

A/A TEST:
Run test with identical variants to verify no systematic bias.
Should show no significant difference.
Validates randomization and measurement.

SAMPLE RATIO MISMATCH (SRM):
Check that actual sample sizes match expected split.
Significant deviation indicates implementation problem.

FORMULA:
Chi_Square = Sum of ((Observed minus Expected)^2 divided by Expected)

POST-TEST VALIDATION:

HOLDOUT VALIDATION:
Reserve portion of data for validation.
Train model on 80 percent, validate on 20 percent.

CROSS-VALIDATION:
K-fold cross-validation for more robust estimates.
Average performance across folds.

NOVELTY AND PRIMACY EFFECTS:
Initial results may not persist.
Recommend 2-4 week observation for stable read.

================================================================================
SECTION 19: SECONDARY EFFECTS AND GUARDRAIL METRICS
================================================================================

19.1 UNDERSTANDING SECONDARY EFFECTS

Marketing interventions rarely affect only the primary KPI. Secondary effects can be positive (spillover benefits) or negative (cannibalization, unintended consequences).

TYPES OF SECONDARY EFFECTS:

SPILLOVER EFFECTS:
Positive impact on related metrics not directly targeted.
Example: Brand campaign increases both awareness and direct response.

CANNIBALIZATION:
Improvement in one area causes decline in another.
Example: Promotion steals sales from full-price period.

HALO EFFECTS:
Indirect positive effects on brand or related products.
Example: Advertising for flagship product lifts entire brand.

NETWORK EFFECTS:
Impact on one user affects other users.
Example: Referring user gets benefit when friend joins.

LONG-TERM VS. SHORT-TERM:
Short-term gains may come at long-term cost.
Example: Heavy discounting damages brand perception.

19.2 GUARDRAIL METRICS FRAMEWORK

DEFINITION:
Guardrail metrics are secondary KPIs monitored during tests to detect unintended negative impacts.

PURPOSE:
- Prevent shipping changes that harm overall business
- Ensure primary metric gains do not come at unacceptable cost
- Provide holistic view of experiment impact

GUARDRAIL CATEGORIES (Following Airbnb Framework):

BUSINESS HEALTH:
- Revenue
- Bookings or conversions
- Customer lifetime value

USER EXPERIENCE:
- Page load time
- Error rates
- Bounce rates
- Session duration

QUALITY:
- Customer satisfaction scores
- Support ticket volume
- Refund rates

19.3 SELECTING GUARDRAIL METRICS

CRITERIA FOR GOOD GUARDRAILS:

- BUSINESS CRITICAL:
Must matter to overall business success.
Not worth monitoring trivial metrics.

- POTENTIALLY AFFECTED:
Should have plausible causal connection to test.
Test changing checkout should monitor cart abandonment.

- SENSITIVE ENOUGH:
Must be able to detect meaningful changes with test sample size.
Run power analysis on guardrails.

- ACTIONABLE:
Must be willing to pause or roll back if guardrail triggered.
No point monitoring metrics you will ignore.

TYPICAL GUARDRAIL SELECTION:
- 2-3 guardrails per test (avoid too many for false positive risk)
- Include at least one business metric and one user experience metric
- Consider both short-term and leading indicators

19.4 GUARDRAIL THRESHOLDS AND TRIGGERS

SETTING THRESHOLDS:

NON-INFERIORITY MARGIN (NIM):
Maximum acceptable degradation in guardrail metric.
Example: Accept up to 2 percent revenue decline if conversion increases 10 percent.

FORMULA:
Guardrail_Pass if: Lower_Bound_CI greater than (Baseline minus NIM)

THRESHOLD SETTING GUIDANCE:
- Revenue: NIM typically 1-3 percent
- Page load time: NIM typically 100-500ms
- Error rates: NIM typically 0.1-0.5 percent absolute

TRIGGER ACTIONS:

GREEN (All Clear):
- Guardrail change statistically insignificant
- Or change is positive
- Proceed with shipping decision based on primary metric

YELLOW (Caution):
- Guardrail trending negative but not significant
- Or small negative significant change
- Review with stakeholders before shipping

RED (Stop):
- Significant negative change exceeding NIM
- Pause experiment immediately
- Investigate root cause before proceeding

19.5 MEASURING UNEXPECTED EFFECTS

COMPREHENSIVE METRIC MONITORING:

EXPLORATORY METRICS:
Beyond pre-specified guardrails, monitor broad set of metrics for discovery.
Use FDR correction for multiple testing.

SEGMENT ANALYSIS:
Check for heterogeneous effects across:
- User segments (new vs. returning)
- Device types
- Geographic regions
- Traffic sources

DOWNSTREAM EFFECTS:
Track metrics further down the funnel:
- Test on landing page affects checkout rate?
- Test on pricing affects refund rate?
- Test on acquisition affects retention?

19.6 LONG-TERM EFFECT MEASUREMENT

SHORT-TERM VS. LONG-TERM:

NOVELTY EFFECTS:
Initial positive results may fade as users habituate.
Recommendation: Monitor 4-8 weeks post-implementation.

PRIMACY EFFECTS:
Users prefer familiar interface initially.
New features may show negative then positive trajectory.

LONG-TERM HOLDOUTS:
Maintain small persistent holdout (1-5 percent) for long-term measurement.
Enables detection of cumulative or delayed effects.

MEASUREMENT APPROACH:
- Week 1-2: Novelty and primacy period, read with caution
- Week 3-4: Stabilization period
- Month 2-6: Long-term effect measurement
- Compare long-term holdout to shipped experience

19.7 CANNIBALIZATION DETECTION

CANNIBALIZATION INDICATORS:

ZERO-SUM PATTERN:
Gain in test metric approximately equals loss in related metric.
Example: Email promo increases email revenue but decreases organic revenue.

TIMING SHIFT:
Total unchanged but timing shifted.
Example: Promotion pulls forward purchases that would have happened anyway.

CHANNEL SHIFT:
Revenue moves between channels without increasing total.
Example: Paid search steals from organic search.

MEASUREMENT:

TOTAL EFFECT ANALYSIS:
Sum all related metrics to detect net impact.
Test_Total = Sum of all conversion sources

DIFFERENCE-IN-DIFFERENCES:
Compare change in test channel vs. change in other channels.
If other channels decline proportionally, likely cannibalization.

INCREMENTALITY TESTING:
Use geo-holdout to measure true incremental impact.
Controls for cannibalization by measuring total business impact.

19.8 AGENT GUIDANCE FOR SECONDARY EFFECTS

PRE-TEST:
- Identify plausible secondary effects before test
- Define 2-3 guardrail metrics with thresholds
- Run power analysis on guardrails
- Set monitoring and escalation procedures

DURING TEST:
- Monitor guardrails daily or weekly
- Flag any yellow or red conditions immediately
- Do not ship if guardrails are red

POST-TEST:
- Report guardrail status alongside primary metric
- Conduct exploratory analysis for unexpected effects
- Consider long-term holdout for significant changes

REPORTING TEMPLATE:
When presenting test results, include:
- Primary metric result with significance
- Guardrail metric status (green/yellow/red)
- Secondary metrics of interest
- Segment analysis summary
- Recommendation accounting for all effects

================================================================================
SECTION 20: RELATED DOCUMENTS
================================================================================

This Analytics Engine works in conjunction with:

PRIMARY DOCUMENTS:
- MPA_v55_Instructions_Uplift.txt (in copilot folder) - Agent behavioral guidance
[Removed - architecture guidance integrated into Strategic_Wisdom]
- Gap_Detection_Playbook_v5_5.txt - Gap resolution methodology

REGISTRIES:
- mpa_kpi table (Dataverse) - KPI definitions and benchmarks
- mpa_channel table (Dataverse) - Channel specifications
- mpa_partner table (Dataverse) - Partner information
- mpa_vertical and mpa_benchmark tables (Dataverse) - Industry benchmarks

FRAMEWORKS:
- Confidence_Level_Framework_v5_5.txt - Confidence methodology
- Data_Provenance_Framework_v5_5.txt - Data source hierarchy
- [Removed - decision logic integrated into Supporting_Instructions]

SPO DOCUMENTATION:
- [Archived - SPO guidance now in Strategic_Wisdom] - SPO trigger conditions
- SPO_Fee_Benchmarks_v1.docx - Fee benchmarks

================================================================================
COMPLIANCE NOTES
================================================================================

This document follows the 6-Rule Compliance Framework:

- ALL-CAPS HEADERS: All section headers use uppercase
- SIMPLE LISTS: Hyphens only for list items
- ASCII ONLY: No special characters or unicode
- ZERO VISUAL DEPENDENCIES: No images or complex formatting
- MANDATORY LANGUAGE: Professional tone throughout
- AGENT-READY: Decision logic and formulas included

================================================================================
VERSION HISTORY
================================================================================

Version 5.0.2 (January 2026):
- Added Section 14: RFM Analysis Fundamentals
  - Recency, Frequency, Monetary value definitions
  - Quintile scoring methodology
  - Standard customer segments (Champions through Lost)
  - RFM visualization approaches
  - RFM variations (RFE, RFD)
  - Integration with probabilistic LTV models
- Renumbered sections 14-20 for sequential ordering
- Added RFM formulas to Quick Reference (Section 13.6)
- Updated formula numbering (13.6-13.10)

Version 5.0.1 (January 2026):
- Added Section 15: Customer Lifetime Value Models
  - Deterministic LTV formulas
  - Probabilistic models (BG/NBD, Pareto/NBD, Gamma-Gamma)
  - LTV to CAC ratio interpretation
- Added Section 16: Decile Analysis and Marginal Optimization
  - Decile table construction
  - Breakeven analysis for direct marketing
  - Marginal dollar allocation principles
- Added Section 17: Cohort and Vintage Analysis
  - Retention matrix construction
  - 5-year lifecycle forecasting methodology
  - Vintage analysis for acquisition quality
- Added Section 18: Advanced Statistical Framework
  - Statistical significance and hypothesis testing
  - Power analysis and sample size calculation
  - Minimum detectable effect (MDE)
  - Multiple testing corrections
  - Validation methodology
- Added Section 19: Secondary Effects and Guardrail Metrics
  - Spillover and cannibalization detection
  - Guardrail metric selection and thresholds
  - Long-term effect measurement
- Updated scope to include new analytical capabilities
- Renumbered Related Documents to Section 20

Version 5.0 (January 2026):
- Initial Analytics Engine creation
- Consolidated calculation specs from architecture documents
- Added deep research on analytical models
- Included MMM, adstock, reach/frequency, response curves
- Added attribution and incrementality sections
- Created formula quick reference
- Integrated with v5.0 architecture

================================================================================
END OF DOCUMENT
================================================================================
