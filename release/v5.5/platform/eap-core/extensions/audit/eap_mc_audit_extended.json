{
  "schemaName": "eap_mc_audit_extended",
  "displayName": "Extended Audit Log",
  "pluralName": "Extended Audit Logs",
  "description": "Enhanced audit logging for Mastercard compliance requirements",
  "primaryColumn": "event_id",
  "ownershipType": "OrganizationOwned",
  "tableType": "Standard",
  "columns": [
    {
      "schemaName": "event_id",
      "displayName": "Event ID",
      "type": "Text",
      "format": "Text",
      "maxLength": 50,
      "required": true,
      "description": "Unique event identifier"
    },
    {
      "schemaName": "base_audit_id",
      "displayName": "Base Audit Reference",
      "type": "Lookup",
      "target": "eap_audit",
      "required": false,
      "description": "Reference to base EAP audit record"
    },
    {
      "schemaName": "user_email",
      "displayName": "User Email",
      "type": "Text",
      "format": "Email",
      "maxLength": 200,
      "required": true,
      "description": "Email of user who performed action"
    },
    {
      "schemaName": "user_department",
      "displayName": "User Department",
      "type": "Text",
      "format": "Text",
      "maxLength": 200,
      "required": false,
      "description": "Department of user at time of action"
    },
    {
      "schemaName": "user_businessunit",
      "displayName": "User Business Unit",
      "type": "Text",
      "format": "Text",
      "maxLength": 200,
      "required": false,
      "description": "Business unit of user at time of action"
    },
    {
      "schemaName": "action_type",
      "displayName": "Action Type",
      "type": "Choice",
      "options": [
        {"value": "CREATE", "label": "Create"},
        {"value": "READ", "label": "Read"},
        {"value": "UPDATE", "label": "Update"},
        {"value": "DELETE", "label": "Delete"},
        {"value": "EXPORT", "label": "Export"},
        {"value": "SHARE", "label": "Share"},
        {"value": "LOGIN", "label": "Login"},
        {"value": "LOGOUT", "label": "Logout"},
        {"value": "SEARCH", "label": "Search"},
        {"value": "GENERATE", "label": "Generate"}
      ],
      "required": true,
      "description": "Type of action performed"
    },
    {
      "schemaName": "resource_type",
      "displayName": "Resource Type",
      "type": "Text",
      "format": "Text",
      "maxLength": 100,
      "required": false,
      "description": "Type of resource accessed"
    },
    {
      "schemaName": "resource_id",
      "displayName": "Resource ID",
      "type": "Text",
      "format": "Text",
      "maxLength": 100,
      "required": false,
      "description": "ID of resource accessed"
    },
    {
      "schemaName": "resource_classification",
      "displayName": "Resource Classification",
      "type": "Choice",
      "options": [
        {"value": "PUBLIC", "label": "Public"},
        {"value": "INTERNAL", "label": "Internal"},
        {"value": "CONFIDENTIAL", "label": "Confidential"},
        {"value": "RESTRICTED", "label": "Restricted"}
      ],
      "required": false,
      "description": "Data classification of accessed resource"
    },
    {
      "schemaName": "ip_address",
      "displayName": "IP Address",
      "type": "Text",
      "format": "Text",
      "maxLength": 50,
      "required": false,
      "description": "IP address of request origin"
    },
    {
      "schemaName": "user_agent",
      "displayName": "User Agent",
      "type": "Text",
      "format": "Text",
      "maxLength": 500,
      "required": false,
      "description": "Browser or client user agent string"
    },
    {
      "schemaName": "session_id",
      "displayName": "Session ID",
      "type": "Text",
      "format": "Text",
      "maxLength": 100,
      "required": false,
      "description": "Associated session identifier"
    },
    {
      "schemaName": "request_payload_hash",
      "displayName": "Request Payload Hash",
      "type": "Text",
      "format": "Text",
      "maxLength": 100,
      "required": false,
      "description": "SHA-256 hash of request payload - not the payload itself"
    },
    {
      "schemaName": "response_status",
      "displayName": "Response Status",
      "type": "Choice",
      "options": [
        {"value": "SUCCESS", "label": "Success"},
        {"value": "FAILURE", "label": "Failure"},
        {"value": "PARTIAL", "label": "Partial"},
        {"value": "DENIED", "label": "Denied"}
      ],
      "required": false,
      "description": "Outcome of the action"
    },
    {
      "schemaName": "failure_reason",
      "displayName": "Failure Reason",
      "type": "Text",
      "format": "Text",
      "maxLength": 500,
      "required": false,
      "description": "Reason for failure if applicable"
    },
    {
      "schemaName": "timestamp",
      "displayName": "Timestamp",
      "type": "DateTime",
      "format": "DateAndTime",
      "required": true,
      "description": "When the event occurred"
    },
    {
      "schemaName": "retention_date",
      "displayName": "Retention Date",
      "type": "DateTime",
      "format": "DateOnly",
      "required": false,
      "description": "Date when this record can be purged per retention policy"
    }
  ],
  "relationships": [
    {
      "name": "base_audit_link",
      "type": "ManyToOne",
      "relatedTable": "eap_audit",
      "relatedColumn": "base_audit_id",
      "cascadeDelete": "RemoveLink"
    }
  ],
  "indexes": [
    {
      "name": "idx_audit_user_email",
      "columns": ["user_email"],
      "unique": false
    },
    {
      "name": "idx_audit_timestamp",
      "columns": ["timestamp"],
      "unique": false
    },
    {
      "name": "idx_audit_action_type",
      "columns": ["action_type"],
      "unique": false
    },
    {
      "name": "idx_audit_resource",
      "columns": ["resource_type", "resource_id"],
      "unique": false
    },
    {
      "name": "idx_audit_classification",
      "columns": ["resource_classification"],
      "unique": false
    },
    {
      "name": "idx_audit_retention",
      "columns": ["retention_date"],
      "unique": false
    }
  ],
  "retentionPolicy": {
    "defaultRetentionDays": 90,
    "restrictedAccessRetentionDays": 365,
    "exportShareRetentionDays": 365,
    "failedAccessRetentionDays": 365
  }
}
