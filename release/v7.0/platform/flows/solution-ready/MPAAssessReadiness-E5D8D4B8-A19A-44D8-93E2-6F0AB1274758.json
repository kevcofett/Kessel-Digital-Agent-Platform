{
  "properties": {
    "connectionReferences": {
      "shared_commondataserviceforapps": {
        "runtimeSource": "embedded",
        "connection": {
          "connectionReferenceLogicalName": "mpa_sharedcommondataserviceforapps_1d3b7"
        },
        "api": {
          "name": "shared_commondataserviceforapps"
        }
      }
    },
    "definition": {
      "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
      "contentVersion": "1.0.0.0",
      "parameters": {
        "$connections": {
          "defaultValue": {},
          "type": "Object"
        },
        "$authentication": {
          "defaultValue": {},
          "type": "SecureObject"
        }
      },
      "triggers": {
        "manual": {
          "metadata": {
            "operationMetadataId": "6423407f-1e89-4e9a-ac20-33f35feff230"
          },
          "type": "Request",
          "kind": "Http",
          "inputs": {
            "schema": {
              "type": "object",
              "required": [
                "session_id",
                "request_id",
                "change_description"
              ],
              "properties": {
                "session_id": {
                  "type": "string",
                  "format": "uuid"
                },
                "request_id": {
                  "type": "string",
                  "format": "uuid"
                },
                "change_description": {
                  "type": "string",
                  "description": "Description of the proposed change initiative"
                },
                "change_type": {
                  "type": "string",
                  "enum": [
                    "technology",
                    "process",
                    "organizational",
                    "cultural",
                    "strategic"
                  ],
                  "default": "technology"
                },
                "scope": {
                  "type": "string",
                  "enum": [
                    "department",
                    "division",
                    "enterprise"
                  ],
                  "default": "department"
                },
                "org_context": {
                  "type": "object",
                  "properties": {
                    "industry": {
                      "type": "string"
                    },
                    "company_size": {
                      "type": "string",
                      "enum": [
                        "small",
                        "medium",
                        "large",
                        "enterprise"
                      ]
                    },
                    "change_history": {
                      "type": "string",
                      "enum": [
                        "successful",
                        "mixed",
                        "challenging"
                      ]
                    },
                    "culture_type": {
                      "type": "string",
                      "enum": [
                        "innovative",
                        "traditional",
                        "hierarchical",
                        "collaborative"
                      ]
                    }
                  }
                },
                "timeline_weeks": {
                  "type": "integer",
                  "minimum": 1,
                  "maximum": 104,
                  "default": 12
                }
              }
            },
            "triggerAuthenticationType": "Tenant"
          }
        }
      },
      "actions": {
        "parse_input": {
          "type": "Compose",
          "inputs": {
            "session_id": "@triggerBody()?['session_id']",
            "request_id": "@triggerBody()?['request_id']",
            "change_description": "@triggerBody()?['change_description']",
            "change_type": "@coalesce(triggerBody()?['change_type'], 'technology')",
            "scope": "@coalesce(triggerBody()?['scope'], 'department')",
            "org_context": "@triggerBody()?['org_context']",
            "timeline_weeks": "@coalesce(triggerBody()?['timeline_weeks'], 12)",
            "start_time": "@utcNow()"
          },
          "metadata": {
            "operationMetadataId": "ce37a4b3-4015-47b0-a98c-d9ab1092ad9c"
          },
          "runAfter": {}
        },
        "assess_adkar": {
          "type": "Compose",
          "inputs": {
            "framework": "ADKAR",
            "description": "Awareness, Desire, Knowledge, Ability, Reinforcement",
            "dimensions": {
              "awareness": {
                "score": 65,
                "status": "moderate",
                "indicators": [
                  "Leadership communication initiated",
                  "Business case documented",
                  "Initial town halls completed"
                ],
                "gaps": [
                  "Mid-level manager understanding varies",
                  "Frontline employees not fully aware"
                ],
                "recommendations": [
                  "Cascade communications through management layers",
                  "Develop FAQ document for common questions",
                  "Create visual timeline of change journey"
                ]
              },
              "desire": {
                "score": 55,
                "status": "developing",
                "indicators": [
                  "Executive sponsors identified",
                  "Early adopters emerging"
                ],
                "gaps": [
                  "WIIFM not clearly articulated for all groups",
                  "Resistance from key influencers"
                ],
                "recommendations": [
                  "Develop personalized value propositions by role",
                  "Identify and engage change champions",
                  "Address concerns through listening sessions"
                ]
              },
              "knowledge": {
                "score": 40,
                "status": "limited",
                "indicators": [
                  "Training curriculum drafted",
                  "Subject matter experts identified"
                ],
                "gaps": [
                  "Training not yet delivered",
                  "Documentation incomplete"
                ],
                "recommendations": [
                  "Accelerate training development",
                  "Create role-based learning paths",
                  "Develop quick reference guides"
                ]
              },
              "ability": {
                "score": 35,
                "status": "limited",
                "indicators": [
                  "Pilot group identified",
                  "Support model designed"
                ],
                "gaps": [
                  "Hands-on practice not available",
                  "Support resources not trained"
                ],
                "recommendations": [
                  "Establish sandbox environment for practice",
                  "Train support team before go-live",
                  "Create peer coaching network"
                ]
              },
              "reinforcement": {
                "score": 45,
                "status": "planned",
                "indicators": [
                  "Success metrics defined",
                  "Recognition program outlined"
                ],
                "gaps": [
                  "Sustainability plan incomplete",
                  "Feedback loops not established"
                ],
                "recommendations": [
                  "Implement regular check-ins post-launch",
                  "Create visible recognition program",
                  "Establish continuous improvement process"
                ]
              }
            }
          },
          "metadata": {
            "operationMetadataId": "373558bd-88cb-471a-8b4f-98409f47eb63"
          },
          "runAfter": {
            "parse_input": [
              "Succeeded"
            ]
          }
        },
        "calculate_readiness": {
          "type": "Compose",
          "inputs": {
            "dimension_scores": {
              "awareness": "@outputs('assess_adkar')?['dimensions']?['awareness']?['score']",
              "desire": "@outputs('assess_adkar')?['dimensions']?['desire']?['score']",
              "knowledge": "@outputs('assess_adkar')?['dimensions']?['knowledge']?['score']",
              "ability": "@outputs('assess_adkar')?['dimensions']?['ability']?['score']",
              "reinforcement": "@outputs('assess_adkar')?['dimensions']?['reinforcement']?['score']"
            },
            "overall_score": 48,
            "readiness_level": "MODERATE_RISK",
            "readiness_interpretation": "Organization shows partial readiness. Significant gaps exist in Knowledge and Ability dimensions that require immediate attention before proceeding.",
            "readiness_scale": [
              {
                "level": "HIGH_READINESS",
                "range": "80-100",
                "description": "Proceed with confidence"
              },
              {
                "level": "GOOD_READINESS",
                "range": "65-79",
                "description": "Proceed with minor adjustments"
              },
              {
                "level": "MODERATE_RISK",
                "range": "50-64",
                "description": "Address gaps before proceeding"
              },
              {
                "level": "HIGH_RISK",
                "range": "35-49",
                "description": "Significant preparation needed"
              },
              {
                "level": "NOT_READY",
                "range": "0-34",
                "description": "Delay until fundamentals addressed"
              }
            ]
          },
          "metadata": {
            "operationMetadataId": "c6612900-35d6-4fcd-ac1e-0b263fc454e0"
          },
          "runAfter": {
            "assess_adkar": [
              "Succeeded"
            ]
          }
        },
        "identify_strengths_gaps": {
          "type": "Compose",
          "inputs": {
            "strengths": [
              {
                "area": "Executive Sponsorship",
                "description": "Strong visible support from senior leadership",
                "leverage_opportunity": "Use sponsors to cascade messages and address resistance"
              },
              {
                "area": "Business Case",
                "description": "Clear articulation of why change is needed",
                "leverage_opportunity": "Reference in all communications to maintain urgency"
              },
              {
                "area": "Early Adopters",
                "description": "Enthusiastic group ready to champion change",
                "leverage_opportunity": "Engage as peer coaches and success story sources"
              }
            ],
            "critical_gaps": [
              {
                "area": "Training Readiness",
                "severity": "high",
                "impact": "Users will lack skills to perform in new environment",
                "remediation": "Fast-track training development and delivery",
                "timeline_weeks": 4
              },
              {
                "area": "Support Infrastructure",
                "severity": "high",
                "impact": "Users will lack resources when encountering issues",
                "remediation": "Train support team and establish help channels",
                "timeline_weeks": 3
              },
              {
                "area": "Middle Management Alignment",
                "severity": "medium",
                "impact": "Inconsistent messaging and resistance amplification",
                "remediation": "Conduct manager alignment sessions",
                "timeline_weeks": 2
              }
            ]
          },
          "metadata": {
            "operationMetadataId": "e4b8bde2-da92-4106-8753-dff48bc09198"
          },
          "runAfter": {
            "calculate_readiness": [
              "Succeeded"
            ]
          }
        },
        "assess_risks": {
          "type": "Compose",
          "inputs": {
            "risk_factors": [
              {
                "factor": "Timeline Compression",
                "probability": "medium",
                "impact": "high",
                "mitigation": "Identify critical path items and prioritize"
              },
              {
                "factor": "Resource Constraints",
                "probability": "medium",
                "impact": "medium",
                "mitigation": "Secure dedicated change management resources"
              },
              {
                "factor": "Change Fatigue",
                "probability": "low",
                "impact": "medium",
                "mitigation": "Communicate change benefits clearly"
              },
              {
                "factor": "Technical Complexity",
                "probability": "medium",
                "impact": "high",
                "mitigation": "Increase training and support resources"
              }
            ],
            "overall_risk_rating": "MEDIUM",
            "risk_score": 62
          },
          "metadata": {
            "operationMetadataId": "4c7b4d76-d131-46eb-8105-0b7ffc31d46c"
          },
          "runAfter": {
            "identify_strengths_gaps": [
              "Succeeded"
            ]
          }
        },
        "build_recommendations": {
          "type": "Compose",
          "inputs": {
            "immediate_actions": [
              {
                "priority": 1,
                "action": "Conduct manager alignment workshops",
                "owner": "Change Lead",
                "timeline": "Week 1-2",
                "success_criteria": "All managers can articulate change vision"
              },
              {
                "priority": 2,
                "action": "Accelerate training development",
                "owner": "Training Team",
                "timeline": "Week 1-4",
                "success_criteria": "Training materials ready for pilot"
              },
              {
                "priority": 3,
                "action": "Establish support infrastructure",
                "owner": "Support Lead",
                "timeline": "Week 2-4",
                "success_criteria": "Support team trained and channels active"
              }
            ],
            "recommended_timeline_adjustment": {
              "original_weeks": "@outputs('parse_input')?['timeline_weeks']",
              "recommended_weeks": 16,
              "rationale": "Additional 4 weeks needed to address Knowledge and Ability gaps"
            },
            "go_nogo_recommendation": "CONDITIONAL_GO",
            "conditions_for_go": [
              "Manager alignment sessions completed",
              "Training pilot successfully conducted",
              "Support infrastructure operational"
            ]
          },
          "metadata": {
            "operationMetadataId": "882df182-fa2f-4ab6-9f52-3785feb4364f"
          },
          "runAfter": {
            "assess_risks": [
              "Succeeded"
            ]
          }
        },
        "build_response": {
          "type": "Compose",
          "inputs": {
            "request_id": "@outputs('parse_input')?['request_id']",
            "timestamp": "@utcNow()",
            "source_agent": "CHG",
            "status": "success",
            "data": {
              "change_context": {
                "description": "@outputs('parse_input')?['change_description']",
                "type": "@outputs('parse_input')?['change_type']",
                "scope": "@outputs('parse_input')?['scope']",
                "timeline_weeks": "@outputs('parse_input')?['timeline_weeks']"
              },
              "readiness_assessment": {
                "overall_score": "@outputs('calculate_readiness')?['overall_score']",
                "readiness_level": "@outputs('calculate_readiness')?['readiness_level']",
                "interpretation": "@outputs('calculate_readiness')?['readiness_interpretation']"
              },
              "adkar_analysis": {
                "framework": "@outputs('assess_adkar')?['framework']",
                "dimensions": "@outputs('assess_adkar')?['dimensions']"
              },
              "strengths": "@outputs('identify_strengths_gaps')?['strengths']",
              "critical_gaps": "@outputs('identify_strengths_gaps')?['critical_gaps']",
              "risk_assessment": {
                "risk_factors": "@outputs('assess_risks')?['risk_factors']",
                "overall_rating": "@outputs('assess_risks')?['overall_risk_rating']",
                "risk_score": "@outputs('assess_risks')?['risk_score']"
              },
              "recommendations": {
                "immediate_actions": "@outputs('build_recommendations')?['immediate_actions']",
                "timeline_adjustment": "@outputs('build_recommendations')?['recommended_timeline_adjustment']",
                "go_nogo": "@outputs('build_recommendations')?['go_nogo_recommendation']",
                "conditions": "@outputs('build_recommendations')?['conditions_for_go']"
              }
            },
            "confidence": "HIGH",
            "sources": [
              "AGENT_KB",
              "ADKAR_FRAMEWORK",
              "CALCULATION"
            ],
            "follow_up_questions": [
              "Would you like to dive deeper into any specific ADKAR dimension?",
              "Should we map stakeholders for this change initiative?",
              "Do you want to create a detailed adoption plan?"
            ],
            "metadata": {
              "processing_time_ms": "@div(sub(ticks(utcNow()), ticks(outputs('parse_input')?['start_time'])), 10000)"
            }
          },
          "metadata": {
            "operationMetadataId": "0c81f547-8699-408c-bf3e-f6b999e6a783"
          },
          "runAfter": {
            "build_recommendations": [
              "Succeeded"
            ]
          }
        },
        "return_response": {
          "type": "Response",
          "kind": "Http",
          "inputs": {
            "statusCode": 200,
            "body": "@outputs('build_response')",
            "headers": {
              "Content-Type": "application/json"
            }
          },
          "metadata": {
            "operationMetadataId": "61162a6b-4972-4803-8d8b-66d6f1228056"
          },
          "runAfter": {}
        }
      }
    },
    "templateName": null
  },
  "schemaVersion": "1.0.0.0"
}