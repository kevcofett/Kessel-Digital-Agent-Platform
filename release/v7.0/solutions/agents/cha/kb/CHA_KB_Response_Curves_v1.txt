CHA KNOWLEDGE BASE - RESPONSE CURVE FITTING

OVERVIEW

This document provides comprehensive methodology for fitting and analyzing marketing response curves. Response curves describe the relationship between marketing spend and business outcomes. Proper curve fitting enables optimal budget allocation by identifying saturation points and diminishing returns thresholds.

Response curve analysis is fundamental to media mix optimization. Every channel exhibits non-linear response where incremental returns decrease as spend increases. Understanding these curves allows marketers to allocate budgets where marginal returns are highest. This knowledge base covers Hill functions, S-curves, saturation detection, and diminishing returns analysis.

HILL FUNCTION FUNDAMENTALS

EMAX MODEL PARAMETERIZATION

The Hill function, also known as the Emax model, is the most common response curve specification. The function captures the characteristic shape of marketing response: initial steep gains followed by gradual saturation.

Hill function formula:
- Response equals Emax times spend-to-the-power-n divided by (EC50-to-the-power-n plus spend-to-the-power-n)
- Emax is the maximum achievable response (asymptote)
- EC50 is the spend level at half-maximum response
- n is the Hill coefficient controlling curve steepness

Parameter interpretation:
- Higher Emax indicates greater channel potential
- Lower EC50 indicates more efficient channel (reaches half-max sooner)
- Higher n indicates sharper transition from growth to saturation
- n equals 1 produces classic hyperbolic shape
- n greater than 1 produces sigmoid shape with initial lag

Typical parameter ranges for marketing:
- Emax: varies by channel and objective
- EC50: typically 30 to 70 percent of current spend
- n: typically 0.5 to 2.0 for marketing applications

FITTING PROCEDURES

Non-linear least squares estimation:
- Initialize parameters with reasonable starting values
- Minimize sum of squared residuals between observed and predicted response
- Use Levenberg-Marquardt or trust-region algorithms
- Check convergence and parameter stability

Starting value selection:
- Emax: set to 120 percent of maximum observed response
- EC50: set to median spend level
- n: start with 1.0 and allow optimization

Regularization considerations:
- Add penalty term for extreme parameter values
- Constrain Emax to reasonable multiple of observed maximum
- Constrain n to range 0.3 to 3.0 to avoid unrealistic shapes
- Use cross-validation to tune regularization strength

Bayesian estimation alternative:
- Specify prior distributions for each parameter
- Use MCMC sampling to estimate posterior distributions
- Obtain credible intervals for parameter uncertainty
- Propagate uncertainty to response predictions

GOODNESS OF FIT ASSESSMENT

Diagnostic metrics:
- R-squared: proportion of variance explained by model
- RMSE: root mean squared error in original units
- MAPE: mean absolute percentage error
- AIC: Akaike information criterion for model comparison

Visual diagnostics:
- Plot observed versus predicted values
- Plot residuals versus fitted values
- Plot residuals versus spend level
- Check for systematic patterns in residuals

Residual analysis:
- Residuals should be randomly distributed
- No trend in residuals versus spend indicates good fit
- Heteroscedasticity suggests transformation needed
- Autocorrelation in time series requires adjustment

S-CURVE METHODOLOGY

LOGISTIC FUNCTION SPECIFICATION

S-curves model response with initial slow growth, rapid acceleration, then saturation. This shape reflects awareness building before response, common in brand and awareness campaigns.

Logistic function formula:
- Response equals L divided by (1 plus e-to-the-power-negative-k-times-(spend-minus-x0))
- L is the maximum response (upper asymptote)
- k is the steepness of the curve
- x0 is the spend level at the inflection point

Parameter interpretation:
- L represents saturation level
- k controls how quickly saturation is reached
- x0 indicates spend threshold for response acceleration
- Higher k means sharper transition
- Lower x0 means earlier onset of response

Comparison to Hill function:
- S-curve has explicit inflection point
- S-curve better models threshold effects
- Hill function is more flexible at low spend levels
- Choose based on observed response pattern

INFLECTION POINT ANALYSIS

The inflection point is where response acceleration peaks. Below inflection, increasing spend increases response rate. Above inflection, increasing spend decreases response rate.

Inflection point identification:
- Analytically: inflection at x0 for logistic function
- Numerically: find spend level where second derivative equals zero
- Graphically: identify steepest point on curve

Strategic implications of inflection:
- Spend below inflection may not generate meaningful response
- Spend at inflection maximizes response per dollar
- Spend above inflection enters diminishing returns zone
- Minimum viable spend should exceed inflection threshold

DETECTING S-CURVE VERSUS CONCAVE

Not all channels exhibit S-curve behavior. Many channels show purely concave (diminishing returns from first dollar) response.

Detection methodology:
- Fit both S-curve and Hill function to data
- Compare AIC or BIC scores
- Test whether inflection point is within observed spend range
- Visual inspection of low-spend response pattern

Indicators of S-curve presence:
- Observed response near zero at low spend levels
- Accelerating response rate in mid-spend range
- Clear inflection visible in scatter plot
- Brand or awareness objectives more likely S-curve

Indicators of concave response:
- Positive response even at minimal spend
- Continuously decreasing marginal returns
- Performance or conversion objectives more likely concave
- Retargeting and lower-funnel tactics typically concave

SATURATION POINT CALCULATION

DEFINITION AND IDENTIFICATION

The saturation point is where additional spend produces negligible incremental response. Beyond saturation, budget is better allocated to other channels or saved.

Mathematical definitions:
- Absolute saturation: spend level where response reaches 95 percent of maximum
- Marginal saturation: spend level where marginal return falls below threshold
- Economic saturation: spend level where marginal return equals marginal cost

Calculation for Hill function:
- 95 percent saturation occurs at spend equals EC50 times 19-to-the-power-(1/n)
- 90 percent saturation occurs at spend equals EC50 times 9-to-the-power-(1/n)
- 80 percent saturation occurs at spend equals EC50 times 4-to-the-power-(1/n)

Calculation for logistic function:
- 95 percent saturation occurs at spend equals x0 plus ln(19) divided by k
- 90 percent saturation occurs at spend equals x0 plus ln(9) divided by k
- Formula applies for saturation relative to upper asymptote

PRACTICAL SATURATION THRESHOLDS

Business-relevant saturation definitions:
- Conservative: 80 percent of maximum (leaves optimization room)
- Standard: 90 percent of maximum (balanced approach)
- Aggressive: 95 percent of maximum (near full exploitation)

Choosing saturation threshold:
- Use 80 percent when alternative channels have high potential
- Use 90 percent as default for budget optimization
- Use 95 percent when channel is clearly dominant
- Consider channel strategic importance in threshold selection

Saturation across channels:
- Calculate saturation point for each channel
- Compare current spend to saturation point
- Channels spending above saturation are candidates for reallocation
- Channels spending below saturation may warrant increased investment

CONFIDENCE INTERVALS FOR SATURATION

Saturation estimates have uncertainty from parameter estimation. Communicate this uncertainty in recommendations.

Bootstrap approach:
- Resample observed data with replacement
- Refit curve parameters to each bootstrap sample
- Calculate saturation point for each sample
- Report percentile confidence interval

Bayesian approach:
- Use posterior distribution of parameters
- Calculate saturation point for each posterior sample
- Report credible interval for saturation
- Propagate uncertainty through calculations

Practical guidance:
- Wide confidence intervals indicate unreliable saturation estimate
- Collect more data to narrow intervals
- Be conservative when uncertainty is high
- Consider sensitivity analysis with alternative thresholds

DIMINISHING RETURNS ANALYSIS

MARGINAL RETURN CALCULATION

Marginal return is the incremental response from one additional dollar of spend. Diminishing returns means marginal return decreases as spend increases.

Marginal return formula for Hill function:
- Marginal return equals derivative of response with respect to spend
- MR equals Emax times n times EC50-to-the-n times spend-to-the-(n-1) divided by (EC50-to-the-n plus spend-to-the-n) squared

Interpretation at specific spend levels:
- Calculate marginal return at current spend
- Compare to marginal returns of other channels
- Reallocate from low MR to high MR channels
- Iterate until marginal returns equalize across channels

OPTIMAL BUDGET ALLOCATION

Lagrangian optimization framework:
- Maximize total response subject to budget constraint
- Optimal allocation equalizes marginal returns across channels
- Solve using gradient-based methods or analytical solutions

Analytical solution for two channels:
- Find spend levels where marginal returns are equal
- Subject to constraint that spend levels sum to total budget
- Iterate numerically for general case

Practical allocation procedure:
- Estimate response curves for all channels
- Calculate marginal return function for each channel
- Find allocation that equalizes marginal returns
- Verify total spend equals available budget
- Apply minimum spend constraints if needed

DIMINISHING RETURNS REPORTING

Communicate diminishing returns clearly to stakeholders:
- Report current marginal return for each channel
- Show how marginal return changes with spend adjustment
- Visualize diminishing returns with spend-MR charts
- Compare channels on marginal return basis

Key metrics for reporting:
- Current marginal return: response per incremental dollar now
- Spend elasticity: percent response change per percent spend change
- Saturation ratio: current spend divided by saturation point
- Reallocation potential: estimated gain from optimal allocation

ADSTOCK TRANSFORMATION

CARRYOVER EFFECTS

Marketing effects persist beyond the exposure period. Adstock transformations capture this carryover by spreading spend effects across time periods.

Simple adstock formula:
- Adstocked spend at time t equals spend at t plus decay times adstocked spend at t-1
- Decay parameter between 0 and 1 controls persistence
- Higher decay means longer lasting effects
- Decay of 0.5 means half-life of one period

Geometric adstock:
- Weights decline geometrically over time
- Weight at lag L equals decay-to-the-power-L
- Total effect equals spend times (1 divided by (1 minus decay))
- Simple to estimate and interpret

Weibull adstock:
- More flexible decay shape than geometric
- Can model delayed peak effects
- Two parameters: shape and scale
- Shape greater than 1 models delayed peak

ESTIMATING DECAY PARAMETERS

Grid search approach:
- Test range of decay values from 0.1 to 0.9
- For each decay, transform spend and fit response model
- Select decay that minimizes model error
- Verify selected decay is not at boundary

Joint estimation approach:
- Include decay as parameter in non-linear model
- Estimate decay simultaneously with response parameters
- More efficient but requires careful optimization
- Use profile likelihood for confidence intervals

Channel-specific decay expectations:
- TV: high decay (0.6 to 0.8) due to memory effects
- Digital display: moderate decay (0.3 to 0.5)
- Search: low decay (0.1 to 0.3) due to intent-driven response
- Print: moderate to high decay (0.4 to 0.7)

APPLYING ADSTOCK IN CURVE FITTING

Transform spend before fitting response curve:
- Calculate adstocked spend series using estimated decay
- Fit Hill or S-curve using adstocked spend as input
- Interpret parameters relative to adstocked spend
- Convert recommendations back to actual spend

Impact on saturation analysis:
- Saturation point applies to adstocked spend
- Convert to actual spend considering decay
- Higher decay channels reach saturation at lower actual spend
- Account for carryover when planning spend changes

INTEGRATION WITH BUDGET OPTIMIZATION

CONNECTION TO ANL CAPABILITIES

Response curves feed directly into budget optimization algorithms. This knowledge base provides curve specifications that ANL_BUDGET_OPTIMIZE uses for allocation.

Data flow:
- CHA agent fits response curves using historical data
- Curve parameters passed to ANL budget optimizer
- ANL optimizes allocation across channels
- PRF validates results with holdout measurement

Parameter handoff format:
- Curve type: Hill or logistic
- Emax or L parameter
- EC50 or x0 parameter
- n or k parameter
- Adstock decay parameter
- Parameter confidence intervals

UPDATE CYCLES

Response curves should be refreshed regularly:
- Quarterly refresh for stable channels
- Monthly refresh for rapidly changing channels
- Event-triggered refresh after major campaigns
- Annual comprehensive review with extended data

Monitoring for curve drift:
- Track recent residuals against fitted curve
- Flag channels where recent performance deviates
- Trigger reestimation when drift exceeds threshold
- Investigate causes of significant drift

IMPLEMENTATION CHECKLIST

DATA REQUIREMENTS

Minimum data for reliable curve fitting:
- At least 20 observations with varying spend levels
- Spend variation should span at least 50 percent range
- Time series of at least 12 months for seasonal adjustment
- Clean data without major structural breaks

Data preparation steps:
- Aggregate to appropriate time granularity
- Apply seasonal adjustment if needed
- Handle outliers and anomalies
- Create adstock-transformed spend series

Quality checks:
- Verify spend and response data alignment
- Check for data entry errors and duplicates
- Confirm appropriate lag structure
- Validate against known campaign performance

COMMON PITFALLS

Fitting errors to avoid:
- Fitting curve with insufficient spend variation
- Ignoring adstock effects in estimation
- Overfitting with too many parameters
- Extrapolating beyond observed spend range

Interpretation errors to avoid:
- Confusing correlation with causation
- Ignoring confidence intervals in recommendations
- Assuming curves are stable over time
- Applying curves without checking assumptions

Business application errors:
- Recommending spend beyond saturation
- Ignoring competitive dynamics
- Failing to account for capacity constraints
- Not validating curve predictions with experiments

CAPABILITY REFERENCE

This knowledge base supports the following CHA agent capabilities:

CHA_CURVE_HILL - Hill function (Emax model) fitting with non-linear least squares estimation and goodness of fit assessment

CHA_CURVE_SCURVE - S-curve (logistic function) detection and fitting with inflection point analysis

CHA_CURVE_SATURATION - Saturation point calculation with confidence intervals for Hill and logistic curves

CHA_CURVE_DIMINISHING - Diminishing returns analysis with marginal return calculation and optimal allocation guidance

END OF DOCUMENT
