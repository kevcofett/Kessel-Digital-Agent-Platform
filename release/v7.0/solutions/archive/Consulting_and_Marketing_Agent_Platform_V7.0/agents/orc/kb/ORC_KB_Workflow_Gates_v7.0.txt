ORCHESTRATOR WORKFLOW GATES REFERENCE

This document provides detailed gate validation logic for the Orchestrator Agent. Gates represent quality checkpoints that ensure sufficient information exists before advancing to subsequent workflow phases.

GATE PHILOSOPHY

Gates exist to prevent incomplete plans. A plan missing foundation elements will fail in strategy phases. A plan missing strategy elements will fail in tactical execution. Gates enforce logical dependencies and ensure each phase builds on complete prior work.

GATE STRUCTURE OVERVIEW

The 10-step workflow contains four gates:
- Gate 1 follows Steps 1-3 (Foundation)
- Gate 2 follows Steps 4-6 (Strategy)
- Gate 3 follows Steps 7-9 (Tactics)
- Gate 4 follows Step 10 (Finalization)

GATE 1 - FOUNDATION COMPLETE

Gate 1 validates that foundation elements exist before strategy work begins.

REQUIRED ELEMENTS FOR GATE 1

Client Context (Step 1) must include:
- Industry vertical identified
- Market position described
- Compliance requirements listed
- Geographic scope defined
- Business model understood

Objectives (Step 2) must include:
- Primary KPI selected
- Target value or range specified
- Success criteria defined
- Secondary KPIs identified if applicable
- Measurement timeframe established

Budget (Step 3) must include:
- Total budget amount confirmed
- Currency specified
- Pacing approach selected
- Budget flexibility indicated
- Allocation philosophy discussed

GATE 1 VALIDATION LOGIC

All three steps must show status COMPLETE in session state. If any step shows INCOMPLETE or PARTIAL, Gate 1 remains closed.

When user attempts to advance past Gate 1 with incomplete foundation:
- Identify which specific elements are missing
- Explain why these elements matter for subsequent steps
- Offer to help complete the missing elements
- Do not allow strategy work until Gate 1 passes

GATE 1 REASONABLENESS VALIDATION

In addition to completeness, Gate 1 must validate that stated targets and constraints are reasonable. This prevents building plans on unrealistic assumptions.

KPI TARGET REASONABLENESS CHECK

When KPI target is stated, compare against vertical benchmarks:

Step 1: Retrieve benchmark range from EAP_KB_Realtime_Benchmarks for stated vertical and objective
Step 2: Identify p25 p50 and p75 percentile values
Step 3: Compare user stated target to benchmark range
Step 4: Classify target and communicate finding

Classification Logic:
- If target better than p25: Classify as AGGRESSIVE
- If target between p25 and p75: Classify as REALISTIC
- If target worse than p75: Classify as CONSERVATIVE

AGGRESSIVE Target Response:
Your target of X is at the aggressive end compared to typical vertical benchmarks of Y to Z. This is achievable but will require strong execution across creative, targeting, and optimization. Before proceeding, I want to confirm you understand the critical success factors. Shall I document what needs to go right to hit this target?

REALISTIC Target Response:
Your target of X aligns well with typical vertical benchmarks of Y to Z. This gives us a solid foundation to build the plan.

CONSERVATIVE Target Response:
Your target of X is conservative compared to typical vertical benchmarks of Y to Z. This builds in safety margin. Would you like to explore more aggressive targets that could increase volume, or maintain this buffer?

BUDGET REASONABLENESS CHECK

Validate budget against stated scope:

Check 1: Budget versus channel count
- Calculate budget per channel if distributed evenly
- Compare to minimum viable thresholds per channel
- If any channel would fall below minimum: Flag and recommend consolidation

Check 2: Budget versus objective scale
- Calculate implied volume at benchmark rates
- Compare to stated volume objectives
- If budget insufficient for stated volume: Flag gap and discuss options

Check 3: Budget versus timeline
- Calculate weekly or monthly spend rate
- Compare to platform minimum pacing requirements
- If pacing too thin for optimization: Flag and discuss alternatives

Budget Reasonableness Response Example:
I want to flag a potential gap. Your 75K budget targeting 5000 app installs implies a 15 dollar CPI. Typical benchmarks for this vertical are 40 to 70 dollars CPI. Either the budget needs to increase to approximately 200K to 350K, or we should adjust the install target to approximately 1000 to 1875. Which direction would you prefer to explore?

CRITICAL SUCCESS FACTOR DOCUMENTATION

When AGGRESSIVE targets are confirmed after flagging:

Required Documentation:
- Store target_classification: AGGRESSIVE in session state
- Store critical_success_factors array with specific requirements
- Store acknowledgment_timestamp when user confirms understanding

Critical Success Factors by Objective Type:

For Aggressive CPI targets:
- Creative must outperform benchmarks - plan 3-5 variants minimum
- Targeting must be precise - start narrow expand carefully
- Budget must allow 2-week learning phase before optimization pressure
- Daily monitoring and optimization during first 30 days required
- Contingency for 10-15 percent budget increase if needed

For Aggressive ROAS targets:
- High-intent audience segments required
- Retargeting pool must be established or built quickly
- Proven creative assets preferred over new concepts
- Attribution window must match purchase cycle
- Promotional calendar alignment critical

For Aggressive CPL targets:
- Landing page conversion rate must exceed vertical average
- Form length and fields must be optimized
- Lead quality scoring must be in place
- Sales team capacity must match lead volume
- Follow-up SLAs must be defined

Downstream Handoff:
When routing to CHA or AUD, include critical_success_factors in context:
Note: This campaign has AGGRESSIVE CPI target of X confirmed by user. Critical success factors are: factor list. Channel and audience recommendations should prioritize these factors.

GATE 1 BYPASS CONDITIONS

Gate 1 may be bypassed only when:
- User explicitly requests audit mode for existing plan
- User provides complete plan document for review
- Session type is POSTMORTEM analyzing completed campaign

GATE 2 - STRATEGY COMPLETE

Gate 2 validates that strategy elements exist before tactical work begins.

REQUIRED ELEMENTS FOR GATE 2

Audience (Step 4) must include:
- Primary audience segment defined
- Targeting approach selected
- Audience size estimated
- Data sources identified
- Exclusions specified if applicable

Channels (Step 5) must include:
- Channel mix selected with rationale
- Budget allocation percentages assigned
- Platform-specific strategies noted
- Cross-channel coordination addressed
- Frequency management approach defined

Partners (Step 6) must include:
- DSP selection made or criteria established
- Verification partners identified
- Data providers selected if applicable
- Publisher relationships noted
- Technology stack confirmed

GATE 2 VALIDATION LOGIC

All three strategy steps must show status COMPLETE. Gate 2 also requires Gate 1 to be passed - strategy cannot complete without foundation.

When user attempts tactical work with incomplete strategy:
- Identify missing strategy elements
- Explain dependencies between strategy and tactics
- Route to appropriate specialist to complete gaps
- Block tactical advancement until Gate 2 passes

GATE 2 BYPASS CONDITIONS

Gate 2 may be bypassed only when:
- Session type is INFLIGHT with existing strategy locked
- User provides approved strategy document
- Audit mode reviewing tactical execution only

GATE 3 - TACTICS COMPLETE

Gate 3 validates that tactical elements exist before plan finalization. This gate confirms execution readiness.

REQUIRED ELEMENTS FOR GATE 3

Measurement (Step 7) must include:
- Attribution model selected
- Tracking implementation planned
- Reporting cadence defined
- Success metrics mapped to objectives
- Data collection approach confirmed

Optimization (Step 8) must include:
- Optimization triggers defined
- Reallocation rules established
- Testing approach specified
- Performance thresholds set
- Escalation procedures noted

Compliance (Step 9) must include:
- Brand safety requirements documented
- Regulatory requirements addressed
- Approval workflows identified
- Risk mitigation planned
- Documentation requirements met

GATE 3 EXECUTION CHECK OUTPUT REQUIREMENTS

When validating Gate 3 for execution readiness, output must include these fields:
- channels_selected: Boolean indicating at least one channel is defined with allocation
- budget_allocated: Boolean indicating total budget is set with distribution percentages
- partners_identified: Boolean indicating DSP/SSP partners are identified (warning if missing, not blocking)
- projections_complete: Boolean indicating ANL projections exist (optional)
- gate_status: One of pass, fail, or partial
- missing_requirements: Array of specific items not yet completed
- recommendations: Array of suggested actions to complete the gate

GATE 3 VALIDATION LOGIC

All three tactical steps must show status COMPLETE. Gate 3 requires both Gate 1 and Gate 2 to be passed.

When user asks if ready for execution phase:
- Check channels_selected: session.channel_allocation is not null and has at least one entry
- Check budget_allocated: session.budget_allocation is not null and session.total_budget greater than zero
- Check partners_identified: session.partner_selections is not null OR session.supply_path_defined is true (warning if missing, not blocking)
- Check projections_complete: session.anl_projections is not null (optional)
- Return gate_status as pass if all required checks pass, partial if some pass, fail if none pass
- Include specific missing_requirements for any failed checks
- Provide actionable recommendations for completion

When user requests document generation with incomplete tactics:
- Identify missing tactical elements
- Explain what will be absent from generated documents
- Offer to complete tactical sections first
- Allow partial document generation only with explicit user acknowledgment

GATE 3 BYPASS CONDITIONS

Gate 3 may be bypassed only when:
- User explicitly requests draft document for review
- Time constraints require preliminary output
- User acknowledges incomplete sections will be marked

GATE 4 - FINALIZATION COMPLETE

Gate 4 validates that the plan is ready for delivery.

REQUIRED ELEMENTS FOR GATE 4

Plan Generation (Step 10) must include:
- All prior gates passed
- Document format selected
- Stakeholder requirements addressed
- Review cycle completed
- Final approval obtained or scheduled

GATE 4 VALIDATION LOGIC

Gate 4 requires all prior gates passed plus document generation completed. This gate marks the plan as FINALIZED in session state.

GATE STATUS INDICATORS

Each gate maintains one of these states:
- LOCKED: Prerequisites not met, gate cannot be attempted
- OPEN: Prerequisites met, validation in progress
- PASSED: All requirements satisfied, next phase accessible
- FAILED: Validation attempted but requirements not met

SESSION STATE INTEGRATION

Gate status is stored in session state under workflow_gate field:
- workflow_gate: 0 means no gates passed (initial state)
- workflow_gate: 1 means Gate 1 passed
- workflow_gate: 2 means Gates 1 and 2 passed
- workflow_gate: 3 means Gates 1, 2, and 3 passed
- workflow_gate: 4 means all gates passed (plan complete)

PROGRESSIVE DISCLOSURE

As gates are passed, additional capabilities become available:
- After Gate 1: ANL projections use real budget data
- After Gate 2: CHA recommendations incorporate audience strategy
- After Gate 3: DOC can generate complete tactical briefs
- After Gate 4: Full plan export and delivery enabled

GATE REGRESSION HANDLING

If user modifies foundation elements after passing Gate 1:
- Automatically re-evaluate Gate 1 status
- Flag downstream sections that may need updates
- Notify user of potential cascade effects
- Recommend review of dependent sections

PARTIAL COMPLETION TRACKING

Within each step, track completion percentage:
- 0-25%: Initial information gathered
- 26-50%: Core elements defined
- 51-75%: Details specified
- 76-99%: Nearly complete, minor gaps
- 100%: Step fully complete

GATE VALIDATION MESSAGES

When gate validation fails, provide specific feedback:
- List exact missing elements
- Indicate which step needs attention
- Suggest specific questions to ask user
- Offer to route to specialist for completion

When gate validation succeeds, confirm advancement:
- Summarize completed phase
- Preview next phase requirements
- Offer transition to next logical step
- Update session state accordingly
