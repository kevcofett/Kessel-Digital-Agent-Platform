ANL KNOWLEDGE BASE - MMM ADVANCED v1
VERSION: 1.0
STATUS: Production Ready
COMPLIANCE: 6-Rule Compliant

================================================================================
SECTION 1 - MARKETING MIX MODELING FUNDAMENTALS
================================================================================

MMM DEFINITION

Marketing Mix Modeling (MMM) is an econometric approach that quantifies the impact of marketing activities on business outcomes by analyzing aggregate historical data without requiring user-level tracking.

MMM ADVANTAGES
- Privacy-compliant (no user tracking)
- Captures offline media impact
- Accounts for external factors
- Cross-channel comparable
- Long-term effect measurement

MMM LIMITATIONS
- Requires 2-3 years historical data
- Weekly or monthly granularity
- Slower feedback than digital attribution
- Cannot optimize in real-time
- Assumes relationships continue

CORE MMM EQUATION

Base_Sales = Baseline + Sum(Media_Effects) + Sum(Non_Media_Effects) + Error

EXPANDED FORM
Sales_t = Baseline
        + B1 x Adstock(TV_t)
        + B2 x Adstock(Digital_t)
        + B3 x Adstock(Print_t)
        + B4 x Price_t
        + B5 x Distribution_t
        + B6 x Promo_t
        + Seasonality_t
        + Error_t

================================================================================
SECTION 2 - ADSTOCK TRANSFORMATION
================================================================================

ADSTOCK CONCEPT

Adstock captures the carryover effect of advertising - the notion that advertising impact does not occur only at the moment of exposure but decays over time.

GEOMETRIC ADSTOCK

FORMULA
Adstock_t = Spend_t + Decay x Adstock_t-1

Where:
- Spend_t is current period spending
- Decay (theta) ranges from 0 to 1
- Higher decay = longer carryover

HALF-LIFE CALCULATION
Half_Life = log(0.5) / log(Decay)

DECAY RATE GUIDELINES
- TV (brand): 0.7-0.9 (3-10 week half-life)
- TV (DR): 0.3-0.5 (1-2 week half-life)
- Digital display: 0.2-0.4 (1 week half-life)
- Search: 0.1-0.3 (days to 1 week)
- Radio: 0.4-0.6 (1-3 weeks)
- OOH: 0.5-0.7 (2-4 weeks)
- Print: 0.3-0.5 (1-2 weeks)

WEIBULL ADSTOCK

More flexible shape allowing for delayed peak response.

FORMULA
Adstock_t = Sum(Weight_i x Spend_t-i)
Weight_i = (i / Scale)^(Shape-1) x exp(-(i/Scale)^Shape)

Parameters:
- Shape: Controls when peak effect occurs
- Scale: Controls spread of effect

WHEN TO USE WEIBULL
- Evidence of delayed response (TV brand campaigns)
- Non-monotonic decay patterns
- Need more flexibility than geometric

================================================================================
SECTION 3 - DIMINISHING RETURNS
================================================================================

SATURATION CONCEPT

Media effectiveness diminishes as spending increases. Early impressions are most valuable; additional spending yields progressively less return.

HILL FUNCTION (MOST COMMON)

FORMULA
Saturated_Spend = Spend^Alpha / (Spend^Alpha + K^Alpha)

Parameters:
- Alpha: Steepness of curve
- K: Half-saturation point (spend level at 50% effect)

INTERPRETATION
- Low spend: Near-linear response
- At K: 50% of maximum effect achieved
- High spend: Approaching maximum effect

LOGISTIC SATURATION

FORMULA
Saturated_Spend = 1 / (1 + exp(-Beta x (Spend - Midpoint)))

POWER TRANSFORMATION

FORMULA
Saturated_Spend = Spend^Alpha

Where Alpha less than 1 creates diminishing returns.

CALIBRATING SATURATION

APPROACHES
1. Estimate from data if sufficient variation
2. Use prior beliefs from experiments
3. Apply industry benchmarks
4. Test with incrementality studies

SATURATION BENCHMARKS
- Search: Alpha 0.4-0.6 (faster saturation)
- Social: Alpha 0.5-0.7
- Display: Alpha 0.6-0.8
- TV: Alpha 0.7-0.9 (slower saturation)
- Radio: Alpha 0.6-0.8

================================================================================
SECTION 4 - BAYESIAN MMM APPROACHES
================================================================================

BAYESIAN VS FREQUENTIST

FREQUENTIST APPROACH
- Point estimates with confidence intervals
- Relies on data alone
- Can produce unrealistic coefficients
- Standard regression methods

BAYESIAN APPROACH
- Full posterior distributions
- Incorporates prior knowledge
- Regularizes extreme estimates
- More robust with limited data

BAYESIAN MMM ADVANTAGES
- Incorporate experimental results as priors
- Quantify uncertainty fully
- Prevent nonsensical results
- Better with correlated media

PYMC-MARKETING (PYTHON)

OVERVIEW
Open-source Bayesian MMM library built on PyMC.

KEY FEATURES
- Delayed adstock transformation
- Geometric and Weibull decay
- Logistic saturation
- Time-varying coefficients
- Budget optimization

MODEL SPECIFICATION
- Define priors for all parameters
- Specify adstock and saturation functions
- Fit using MCMC sampling
- Analyze posterior distributions

ROBYN (META OPEN SOURCE)

OVERVIEW
Automated MMM solution with built-in optimization.

KEY FEATURES
- Ridge regression with regularization
- Geometric adstock with flexible shapes
- Hill saturation function
- Multi-objective optimization
- Calibration with experiments
- Automated hyperparameter tuning

ROBYN WORKFLOW
1. Input data preparation
2. Hyperparameter ranges setting
3. Model training (thousands of candidates)
4. Pareto-optimal model selection
5. Budget optimization

CALIBRATION WITH EXPERIMENTS
- Input lift test results
- Constrain coefficient ranges
- Improve model validity
- Recommended for accuracy

LIGHTWEIGHT MMM (GOOGLE)

OVERVIEW
Bayesian MMM using Numpyro for fast inference.

KEY FEATURES
- GPU-accelerated inference
- Hierarchical modeling
- Geo-level modeling
- Media saturation curves
- Posterior predictive checks

================================================================================
SECTION 5 - TIME-VARYING EFFECTS
================================================================================

WHY EFFECTS VARY

Media effectiveness changes over time due to:
- Creative wear-out
- Competitive activity
- Market saturation
- Seasonal patterns
- Economic conditions

MODELING APPROACHES

ROLLING WINDOW MODELS
- Fit model on rolling 1-2 year windows
- Compare coefficients over time
- Simple but loses data

INTERACTION TERMS
- Media x Time interactions
- Media x Season interactions
- Captures systematic variation

TIME-VARYING PARAMETERS
- Allow coefficients to evolve
- Kalman filter or state space models
- More complex, more flexible

REGIME SWITCHING
- Different models for different periods
- Useful for pre/post COVID
- Identify structural breaks

DETECTING CHANGES

STABILITY TESTS
- Chow test for structural breaks
- CUSUM tests for gradual change
- Rolling coefficient plots

INTERPRETATION
- Declining coefficient: Fatigue or market change
- Increasing coefficient: Improved creative or targeting
- Seasonal pattern: Adjust for context

================================================================================
SECTION 6 - BUDGET OPTIMIZATION
================================================================================

OPTIMIZATION OBJECTIVE

MAXIMIZE OUTCOME
Subject to: Total budget constraint
Find: Optimal allocation across channels

MARGINAL RETURN APPROACH

MROI DEFINITION
Marginal return on investment at current spend level.

CALCULATION
mROI = Change in Revenue / Change in Spend

At optimal allocation, marginal returns should be equal across all channels.

OPTIMIZATION ALGORITHM

GRADIENT-BASED
1. Calculate marginal return for each channel
2. Shift budget from low marginal return to high
3. Iterate until marginal returns equalize
4. Respect minimum/maximum constraints

CONSTRAINT TYPES
- Total budget
- Minimum by channel (commitments)
- Maximum by channel (capacity)
- Channel mix constraints (strategy)

SCENARIO ANALYSIS

BUDGET SCENARIOS
- Current budget: Baseline allocation
- +10% budget: Incremental allocation
- -10% budget: Reduction priorities
- Reallocation: Same budget, different mix

OUTPUT METRICS
- Projected revenue by scenario
- Projected ROAS by channel
- Incremental contribution by channel

RESPONSE CURVES

RESPONSE CURVE DEFINITION
Relationship between spend and outcome at different levels.

CURVE CONSTRUCTION
1. Simulate spend at multiple levels
2. Calculate predicted outcome
3. Plot spend vs outcome
4. Identify optimal range

INTERPRETATION
- Steep slope: High marginal return, invest more
- Flat slope: Diminishing returns, may be overinvested
- Inflection point: Optimal spend level

================================================================================
SECTION 7 - MODEL VALIDATION
================================================================================

IN-SAMPLE VALIDATION

FIT METRICS
- R-squared: Variance explained
- MAPE: Mean absolute percentage error
- RMSE: Root mean squared error

RESIDUAL ANALYSIS
- No patterns in residuals
- Homoscedasticity
- Normality (approximate)
- No autocorrelation

OUT-OF-SAMPLE VALIDATION

HOLDOUT TESTING
- Fit model on training period
- Predict holdout period
- Compare predictions to actuals
- MAPE on holdout key metric

CROSS-VALIDATION
- Multiple train/test splits
- Average performance across folds
- More robust than single holdout

EXPERIMENTAL CALIBRATION

LIFT TEST COMPARISON
- Compare MMM-predicted lift to experimental lift
- Should be within reasonable range
- Calibrate if significant deviation

CALIBRATION APPROACHES
- Constrain coefficient posteriors (Bayesian)
- Add calibration loss term (Robyn)
- Adjust final results manually

BUSINESS SENSE CHECKS

FACE VALIDITY
- Are coefficient signs correct?
- Are magnitudes reasonable?
- Do results align with industry benchmarks?

STAKEHOLDER REVIEW
- Do results match business intuition?
- Can unexpected results be explained?
- Are recommendations actionable?

================================================================================
SECTION 8 - IMPLEMENTATION GUIDANCE
================================================================================

DATA REQUIREMENTS

MINIMUM DATA
- 2 years of weekly data (104 observations)
- Preferably 3+ years
- All media spend by channel
- Business outcome (sales, revenue, leads)

ADDITIONAL DATA
- Price and promotion
- Distribution/availability
- Competitive activity
- Macroeconomic indicators
- Weather (if relevant)
- COVID indicators

DATA QUALITY
- Consistent measurement over time
- No missing periods
- Spend aligned with exposure timing
- Currency and unit consistency

MODEL SELECTION

CHOOSE FREQUENTIST WHEN
- Ample data available
- Rapid iteration needed
- Simpler interpretation required
- Limited Bayesian expertise

CHOOSE BAYESIAN WHEN
- Limited data
- Strong prior knowledge
- Need uncertainty quantification
- Experimental data to incorporate

CHOOSE ROBYN WHEN
- Automated workflow needed
- Multiple model comparison
- Budget optimization built-in
- Meta ecosystem experience

REPORTING RECOMMENDATIONS

KEY OUTPUTS
- Contribution by channel (absolute and percent)
- ROI by channel
- Optimal allocation recommendation
- Response curves by channel
- Scenario comparisons

COMMUNICATION TIPS
- Lead with business recommendations
- Use clear visualizations
- Acknowledge uncertainty ranges
- Compare to previous models/experiments
- Explain limitations

REFRESH CADENCE
- Quarterly refresh typical
- Monthly for fast-changing businesses
- Annual for stable categories
- After major market changes

================================================================================
SECTION 9 - ROAS CALCULATION IN MMM
================================================================================

MMM ROAS FORMULA

INCREMENTAL ROAS CALCULATION
iROAS = (Incremental Revenue - Media Spend) / Media Spend

DECOMPOSITION APPROACH
1. Calculate total incremental revenue from media
2. Subtract total media spend
3. Divide by total media spend

BY CHANNEL CALCULATION
Channel_iROAS = (Channel_Incremental_Revenue - Channel_Spend) / Channel_Spend

INTERPRETATION
- iROAS greater than 0: Positive return after recovering ad cost
- iROAS = 0: Breakeven (revenue equals spend)
- iROAS less than 0: Negative return

COMMON CALCULATION ERROR

INCORRECT APPROACH (AVOID)
Some practitioners calculate ROAS as Revenue / Spend without subtracting cost.

EXAMPLE OF ERROR
- Revenue: $500,000
- Spend: $100,000
- Incorrect ROAS: 500,000 / 100,000 = 5.0x
- Correct iROAS: (500,000 - 100,000) / 100,000 = 4.0

The correct formula accounts for recovering the ad investment before measuring return.

================================================================================
END OF DOCUMENT
================================================================================
