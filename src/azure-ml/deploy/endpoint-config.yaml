# Azure ML Managed Online Endpoints Configuration
# KDAP Machine Learning Infrastructure
# Version: 1.0.0
# Date: January 19, 2026

# ============================================================
# BUDGET OPTIMIZATION ENDPOINT
# ============================================================
---
$schema: https://azuremlschemas.azureedge.net/latest/managedOnlineEndpoint.schema.json
name: kdap-budget-optimizer
auth_mode: key
tags:
  agent: ANL
  capability: ANL_BUDGET_OPTIMIZE
  version: "1.0.0"
  environment: production

---
$schema: https://azuremlschemas.azureedge.net/latest/managedOnlineDeployment.schema.json
name: blue
endpoint_name: kdap-budget-optimizer
model:
  path: ./models/budget-optimization
  type: custom_model
code_configuration:
  code: ./scoring
  scoring_script: score_budget_optimization.py
environment:
  conda_file: ./environments/budget-optimization-env.yaml
  image: mcr.microsoft.com/azureml/openmpi4.1.0-ubuntu22.04:latest
instance_type: Standard_DS3_v2
instance_count: 1
request_settings:
  request_timeout_ms: 30000
  max_concurrent_requests_per_instance: 10
liveness_probe:
  initial_delay: 30
  period: 10
  timeout: 10
  success_threshold: 1
  failure_threshold: 3
readiness_probe:
  initial_delay: 30
  period: 10
  timeout: 10
  success_threshold: 1
  failure_threshold: 3

# ============================================================
# PROPENSITY SCORING ENDPOINT
# ============================================================
---
$schema: https://azuremlschemas.azureedge.net/latest/managedOnlineEndpoint.schema.json
name: kdap-propensity
auth_mode: key
tags:
  agent: AUD
  capability: AUD_PROPENSITY
  version: "1.0.0"
  environment: production

---
$schema: https://azuremlschemas.azureedge.net/latest/managedOnlineDeployment.schema.json
name: blue
endpoint_name: kdap-propensity
model:
  path: ./models/propensity-scoring
  type: custom_model
code_configuration:
  code: ./scoring
  scoring_script: score_propensity.py
environment:
  conda_file: ./environments/propensity-env.yaml
  image: mcr.microsoft.com/azureml/openmpi4.1.0-ubuntu22.04:latest
instance_type: Standard_DS3_v2
instance_count: 1
request_settings:
  request_timeout_ms: 20000
  max_concurrent_requests_per_instance: 20

# ============================================================
# ANOMALY DETECTION ENDPOINT
# ============================================================
---
$schema: https://azuremlschemas.azureedge.net/latest/managedOnlineEndpoint.schema.json
name: kdap-anomaly-detector
auth_mode: key
tags:
  agent: PRF
  capability: PRF_ANOMALY
  version: "1.0.0"
  environment: production

---
$schema: https://azuremlschemas.azureedge.net/latest/managedOnlineDeployment.schema.json
name: blue
endpoint_name: kdap-anomaly-detector
model:
  path: ./models/anomaly-detection
  type: custom_model
code_configuration:
  code: ./scoring
  scoring_script: score_anomaly.py
environment:
  conda_file: ./environments/anomaly-env.yaml
  image: mcr.microsoft.com/azureml/openmpi4.1.0-ubuntu22.04:latest
instance_type: Standard_DS2_v2
instance_count: 1
request_settings:
  request_timeout_ms: 15000
  max_concurrent_requests_per_instance: 30

# ============================================================
# MONTE CARLO SIMULATION ENDPOINT
# ============================================================
---
$schema: https://azuremlschemas.azureedge.net/latest/managedOnlineEndpoint.schema.json
name: kdap-monte-carlo
auth_mode: key
tags:
  agent: ANL
  capability: ANL_MONTECARLO
  version: "1.0.0"
  environment: production

---
$schema: https://azuremlschemas.azureedge.net/latest/managedOnlineDeployment.schema.json
name: blue
endpoint_name: kdap-monte-carlo
model:
  path: ./models/monte-carlo
  type: custom_model
code_configuration:
  code: ./scoring
  scoring_script: score_monte_carlo.py
environment:
  conda_file: ./environments/monte-carlo-env.yaml
  image: mcr.microsoft.com/azureml/openmpi4.1.0-ubuntu22.04:latest
instance_type: Standard_DS4_v2
instance_count: 1
request_settings:
  request_timeout_ms: 60000
  max_concurrent_requests_per_instance: 5

# ============================================================
# MEDIA MIX MODELING ENDPOINT
# ============================================================
---
$schema: https://azuremlschemas.azureedge.net/latest/managedOnlineEndpoint.schema.json
name: kdap-media-mix
auth_mode: key
tags:
  agent: CHA
  capability: CHA_MEDIA_MIX
  version: "1.0.0"
  environment: production

---
$schema: https://azuremlschemas.azureedge.net/latest/managedOnlineDeployment.schema.json
name: blue
endpoint_name: kdap-media-mix
model:
  path: ./models/media-mix
  type: custom_model
code_configuration:
  code: ./scoring
  scoring_script: score_media_mix.py
environment:
  conda_file: ./environments/media-mix-env.yaml
  image: mcr.microsoft.com/azureml/openmpi4.1.0-ubuntu22.04:latest
instance_type: Standard_DS4_v2
instance_count: 1
request_settings:
  request_timeout_ms: 120000
  max_concurrent_requests_per_instance: 3

# ============================================================
# SHAPLEY ATTRIBUTION ENDPOINT
# ============================================================
---
$schema: https://azuremlschemas.azureedge.net/latest/managedOnlineEndpoint.schema.json
name: kdap-attribution
auth_mode: key
tags:
  agent: PRF
  capability: PRF_ATTRIBUTION
  version: "1.0.0"
  environment: production

---
$schema: https://azuremlschemas.azureedge.net/latest/managedOnlineDeployment.schema.json
name: blue
endpoint_name: kdap-attribution
model:
  path: ./models/attribution
  type: custom_model
code_configuration:
  code: ./scoring
  scoring_script: score_attribution.py
environment:
  conda_file: ./environments/attribution-env.yaml
  image: mcr.microsoft.com/azureml/openmpi4.1.0-ubuntu22.04:latest
instance_type: Standard_DS3_v2
instance_count: 1
request_settings:
  request_timeout_ms: 45000
  max_concurrent_requests_per_instance: 8

# ============================================================
# RICE PRIORITIZATION ENDPOINT
# ============================================================
---
$schema: https://azuremlschemas.azureedge.net/latest/managedOnlineEndpoint.schema.json
name: kdap-prioritizer
auth_mode: key
tags:
  agent: CST
  capability: CST_PRIORITIZE
  version: "1.0.0"
  environment: production

---
$schema: https://azuremlschemas.azureedge.net/latest/managedOnlineDeployment.schema.json
name: blue
endpoint_name: kdap-prioritizer
model:
  path: ./models/prioritization
  type: custom_model
code_configuration:
  code: ./scoring
  scoring_script: score_prioritization.py
environment:
  conda_file: ./environments/prioritization-env.yaml
  image: mcr.microsoft.com/azureml/openmpi4.1.0-ubuntu22.04:latest
instance_type: Standard_DS2_v2
instance_count: 1
request_settings:
  request_timeout_ms: 10000
  max_concurrent_requests_per_instance: 50
