# Budget Optimizer Model Configuration
# ANL Agent - Media Budget Allocation Optimization

model:
  name: budget_optimizer
  type: regression
  algorithm: lightgbm
  task: budget_allocation
  
features:
  numerical:
    - current_spend
    - historical_roi_mean
    - historical_roi_std
    - audience_size
    - competitive_intensity
    - seasonality_index
    - market_share
    - brand_awareness_score
    - cpm_historical
    - ctr_historical
    - conversion_rate_historical
    
  categorical:
    - channel_id
    - channel_type
    - objective_type
    - industry_vertical
    - campaign_type
    - geo_region
    
  derived:
    - spend_per_impression
    - cost_per_acquisition
    - roi_trend_slope
    - efficiency_score
    - saturation_indicator

target:
  name: optimal_spend_ratio
  type: continuous
  min_value: 0.0
  max_value: 3.0

preprocessing:
  numerical:
    imputer: median
    scaler: robust
    outlier_treatment: winsorize
    winsorize_limits: [0.01, 0.99]
    
  categorical:
    encoder: target
    handle_unknown: value
    min_frequency: 0.01

hyperparameters:
  lightgbm:
    objective: regression
    metric: rmse
    boosting_type: gbdt
    num_leaves: 31
    max_depth: -1
    learning_rate: 0.05
    n_estimators: 1000
    min_child_samples: 20
    subsample: 0.8
    colsample_bytree: 0.8
    reg_alpha: 0.1
    reg_lambda: 0.1
    random_state: 42
    n_jobs: -1
    verbose: -1
    
tuning:
  method: optuna
  n_trials: 100
  timeout: 3600
  metric: rmse
  direction: minimize
  search_space:
    num_leaves:
      type: int
      low: 20
      high: 100
    max_depth:
      type: int
      low: 5
      high: 15
    learning_rate:
      type: float
      low: 0.01
      high: 0.3
      log: true
    n_estimators:
      type: int
      low: 100
      high: 2000
    min_child_samples:
      type: int
      low: 5
      high: 100
    subsample:
      type: float
      low: 0.5
      high: 1.0
    colsample_bytree:
      type: float
      low: 0.5
      high: 1.0
    reg_alpha:
      type: float
      low: 0.0001
      high: 10.0
      log: true
    reg_lambda:
      type: float
      low: 0.0001
      high: 10.0
      log: true

training:
  cv_folds: 5
  early_stopping_rounds: 50
  stratify: false
  
evaluation:
  primary_metric: rmse
  threshold_metrics:
    rmse: 0.15
    mae: 0.10
    r2: 0.75
    mape: 15.0

inference:
  batch_size: 1000
  timeout_ms: 500
  
output:
  predictions:
    - optimal_spend
    - expected_return
    - confidence_interval_lower
    - confidence_interval_upper
    - marginal_return
